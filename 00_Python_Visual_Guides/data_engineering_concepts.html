<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Engineering Concepts</title>
    <!-- Mermaid.js for Diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            themeVariables: {
                fontFamily: 'Segoe UI',
                fontSize: '16px'
            }
        });
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            font-size: 48px;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            font-size: 22px;
            margin-bottom: 40px;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 3px solid #ecf0f1;
            padding-bottom: 10px;
        }

        .tab {
            padding: 15px 30px;
            background: #ecf0f1;
            border: none;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #bdc3c7;
            transform: translateY(-2px);
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-bottom: 4px solid #f39c12;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
        }

        .section-title {
            font-size: 32px;
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .timeline-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            padding: 20px;
            background: #fff;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 20px;
            z-index: 100;
        }

        .timeline-step {
            text-align: center;
            position: relative;
            flex: 1;
            opacity: 0.7;
            transition: all 0.3s ease;
        }

        .timeline-step.active {
            opacity: 1;
            transform: scale(1.05);
        }

        .step-circle {
            width: 40px;
            height: 40px;
            background: #ecf0f1;
            color: #7f8c8d;
            border-radius: 50%;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            position: relative;
            z-index: 2;
            border: 3px solid #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .timeline-step.active .step-circle {
            background: #27ae60;
            color: white;
        }

        .step-line {
            height: 4px;
            background: #ecf0f1;
            position: absolute;
            top: 18px;
            width: 100%;
            left: 50%;
            z-index: 1;
        }

        .timeline-step:last-child .step-line {
            display: none;
        }

        .step-label {
            font-size: 14px;
            font-weight: 600;
            color: #2c3e50;
        }

        /* Responsive adjust for timeline */
        @media (max-width: 768px) {
            .step-label {
                font-size: 10px;
            }

            .step-circle {
                width: 30px;
                height: 30px;
                font-size: 14px;
            }
        }

        /* Tooltip Container */
        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 1px dotted #3498db;
            cursor: pointer;
            color: #2980b9;
            font-weight: bold;
        }

        /* Tooltip Text */
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 300px;
            /* Reduced from 400px */
            background-color: #2c3e50;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 15px;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -150px;
            /* Recenter new width */
            opacity: 0;
            transition: opacity 0.3s;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        /* Fix for tooltips near the right edge */
        .tooltip.right .tooltip-text {
            left: auto;
            right: 0;
            margin-left: 0;
        }

        /* Fix for tooltips near the left edge */
        .tooltip.left .tooltip-text {
            left: 0;
            margin-left: 0;
        }

        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #2c3e50 transparent transparent transparent;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .concept-card {
            background: white;
            border-left: 5px solid #3498db;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .info-box {
            background: linear-gradient(135deg, #e8f4f8 0%, #d4e9f7 100%);
            border-left: 5px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .warning-box {
            background: linear-gradient(135deg, #fff9e6 0%, #ffe6cc 100%);
            border-left: 5px solid #f39c12;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .success-box {
            background: linear-gradient(135deg, #e8f8f5 0%, #d4edda 100%);
            border-left: 5px solid #27ae60;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .comparison-box {
            background: white;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            padding: 20px;
        }

        ul {
            line-height: 2;
            margin-left: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th {
            background: #3498db;
            color: white;
            padding: 12px;
            text-align: left;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #ecf0f1;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        /* Notes Feature Styles */
        .notes-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(243, 156, 18, 0.4);
            z-index: 1000;
            transition: all 0.3s;
        }

        .notes-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(243, 156, 18, 0.6);
        }

        .notes-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100%;
            background: white;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
            z-index: 999;
            transition: right 0.3s;
            overflow-y: auto;
        }

        .notes-panel.open {
            right: 0;
        }

        .notes-header {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notes-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .notes-content {
            padding: 20px;
        }

        .note-item {
            background: #fff9e6;
            border-left: 4px solid #f39c12;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            position: relative;
        }

        .note-tab {
            font-size: 12px;
            color: #95a5a6;
            margin-bottom: 5px;
        }

        .note-text {
            color: #2c3e50;
            line-height: 1.6;
        }

        .note-delete {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 12px;
        }

        .note-input-area {
            margin-top: 20px;
        }

        .note-input-area textarea {
            width: 100%;
            min-height: 100px;
            padding: 10px;
            border: 2px solid #ecf0f1;
            border-radius: 5px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 14px;
            resize: vertical;
        }

        .note-input-area button {
            margin-top: 10px;
            padding: 10px 20px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .note-input-area button:hover {
            background: #229954;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üìä Data Engineering Concepts</h1>
        <div class="subtitle">Progressive Learning Path: Crawl ‚Üí Walk ‚Üí Run</div>

        <div
            style="text-align: center; margin: 20px 0; padding: 20px; background: linear-gradient(135deg, #e8f4f8 0%, #d4e9f7 100%); border-radius: 10px;">
            <h3 style="color: #2c3e50; margin-bottom: 10px;">üéØ How to Use This Guide</h3>
            <div style="display: flex; justify-content: center; gap: 30px; margin-top: 15px;">
                <div style="text-align: center;">
                    <div style="font-size: 32px;">üêõ</div>
                    <strong style="color: #27ae60;">CRAWL</strong>
                    <p style="font-size: 14px; margin: 5px 0;">Learn the basics</p>
                </div>
                <div style="font-size: 24px; color: #95a5a6;">‚Üí</div>
                <div style="text-align: center;">
                    <div style="font-size: 32px;">üö∂</div>
                    <strong style="color: #3498db;">WALK</strong>
                    <p style="font-size: 14px; margin: 5px 0;">Connect the dots</p>
                </div>
                <div style="font-size: 24px; color: #95a5a6;">‚Üí</div>
                <div style="text-align: center;">
                    <div style="font-size: 32px;">üèÉ</div>
                    <strong style="color: #e74c3c;">RUN</strong>
                    <p style="font-size: 14px; margin: 5px 0;">Master & speak confidently</p>
                </div>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="tab active" onclick="showTab('crawl-intro')">üêõ START: Crawl</button>
            <button class="tab" onclick="showTab('databases')">üêõ Databases</button>
            <button class="tab" onclick="showTab('etl-elt')">üêõ ETL vs ELT</button>
            <button class="tab" onclick="showTab('lake-mart')">üêõ Lake & Mart</button>
            <button class="tab" onclick="showTab('warehouse')">üö∂ Warehouse Layers</button>
            <button class="tab" onclick="showTab('architecture')">üö∂ Architecture</button>
            <button class="tab" onclick="showTab('stages')">üö∂ DE Pipeline</button>
            <button class="tab" onclick="showTab('metrics')">üèÉ Metrics & KPIs</button>
            <button class="tab" onclick="showTab('terminology')">üèÉ Terminology</button>
            <button class="tab" onclick="showTab('real-world')">üõí Follow Luke</button>
            <button class="tab" onclick="showTab('quiz')">‚úÖ Test Yourself</button>
            <button class="tab" onclick="showTab('speaking')">üó£Ô∏è Speaking Data</button>
        </div>

        <!-- CRAWL INTRO TAB -->
        <div id="crawl-intro" class="tab-content active">
            <div class="section">
                <div class="section-title">
                    <span style="font-size: 48px;">üêõ</span>
                    <span>Welcome to Your Learning Journey!</span>
                </div>

                <div class="success-box">
                    <h3 style="color: #27ae60;">üéØ How This Guide Works</h3>
                    <p style="font-size: 16px; line-height: 1.8;">
                        This guide is organized to help you learn data engineering concepts progressively, from
                        foundational basics to advanced mastery.
                    </p>
                </div>

                <div class="concept-card" style="border-left-color: #27ae60;">
                    <h3 style="color: #27ae60;">üêõ LEVEL 1: CRAWL (Foundations)</h3>
                    <p style="font-size: 16px; margin: 15px 0;">
                        <strong>Goal:</strong> Understand what each component is and basic differences
                    </p>

                    <div class="info-box">
                        <h4>Topics to Master:</h4>
                        <ul>
                            <li><strong>üêõ Databases:</strong> Learn about different database types (Relational, NoSQL,
                                NewSQL)</li>
                            <li><strong>üêõ ETL vs ELT:</strong> Understand the two approaches to data pipelines</li>
                            <li><strong>üêõ Lake & Mart:</strong> Know the difference between data lakes, warehouses, and
                                marts</li>
                        </ul>
                    </div>

                    <div class="success-box">
                        <h4>‚úÖ You'll Be Able To:</h4>
                        <ul>
                            <li>Explain what OLTP and OLAP mean</li>
                            <li>Describe when to use a database vs data warehouse vs data lake</li>
                            <li>Understand ETL vs ELT at a high level</li>
                            <li>Recognize common data engineering terminology</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #3498db;">
                    <h3 style="color: #3498db;">üö∂ LEVEL 2: WALK (Intermediate)</h3>
                    <p style="font-size: 16px; margin: 15px 0;">
                        <strong>Goal:</strong> Understand how components work together in a complete system
                    </p>

                    <div class="info-box">
                        <h4>Topics to Master:</h4>
                        <ul>
                            <li><strong>üö∂ Warehouse Layers:</strong> Bronze, Silver, Gold architecture</li>
                            <li><strong>üö∂ Architecture:</strong> How all components connect in a data ecosystem</li>
                            <li><strong>üö∂ DE Pipeline:</strong> The 5 stages of data engineering lifecycle</li>
                        </ul>
                    </div>

                    <div class="success-box">
                        <h4>‚úÖ You'll Be Able To:</h4>
                        <ul>
                            <li>Explain the complete data flow from source to BI tool</li>
                            <li>Describe the Bronze-Silver-Gold pattern and why it's used</li>
                            <li>Understand how star schemas enable analytics</li>
                            <li>Draw a data pipeline architecture diagram</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #e74c3c;">
                    <h3 style="color: #e74c3c;">üèÉ LEVEL 3: RUN (Advanced Mastery)</h3>
                    <p style="font-size: 16px; margin: 15px 0;">
                        <strong>Goal:</strong> Master trade-offs, design systems, and speak confidently in interviews
                    </p>

                    <div class="info-box">
                        <h4>Topics to Master:</h4>
                        <ul>
                            <li><strong>üèÉ Metrics & KPIs:</strong> How metrics are calculated from data models</li>
                            <li><strong>üèÉ Terminology:</strong> Deep understanding of all data engineering terms</li>
                        </ul>
                    </div>

                    <div class="success-box">
                        <h4>‚úÖ You'll Be Able To:</h4>
                        <ul>
                            <li>Design complete data architectures for specific use cases</li>
                            <li>Explain trade-offs between different approaches</li>
                            <li>Calculate and explain different metric types</li>
                            <li>Speak confidently about data engineering in interviews</li>
                        </ul>
                    </div>
                </div>

                <div class="warning-box">
                    <h3 style="text-align: center;">üìö Recommended Learning Path</h3>
                    <div style="text-align: center; font-size: 18px; line-height: 3; margin: 20px 0;">
                        <div style="color: #27ae60;"><strong>Week 1:</strong> Complete all üêõ CRAWL tabs</div>
                        <div style="font-size: 24px;">‚Üì</div>
                        <div style="color: #3498db;"><strong>Week 2:</strong> Complete all üö∂ WALK tabs</div>
                        <div style="font-size: 24px;">‚Üì</div>
                        <div style="color: #e74c3c;"><strong>Week 3:</strong> Complete all üèÉ RUN tabs</div>
                        <div style="font-size: 24px;">‚Üì</div>
                        <div style="color: #9b59b6;"><strong>Week 4:</strong> Take the ‚úÖ Quiz and review weak areas
                        </div>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #f39c12;">
                    <h3 style="color: #f39c12;">üí° Study Tips</h3>
                    <ul style="font-size: 16px; line-height: 2;">
                        <li><strong>Don't skip levels:</strong> Each level builds on the previous one</li>
                        <li><strong>Take notes:</strong> Write down key concepts in your own words</li>
                        <li><strong>Draw diagrams:</strong> Visualize how components connect</li>
                        <li><strong>Practice explaining:</strong> Teach concepts to someone else (or yourself out loud)
                        </li>
                        <li><strong>Use the quiz:</strong> Test your understanding before moving to the next level</li>
                        <li><strong>Review regularly:</strong> Revisit previous tabs to reinforce learning</li>
                    </ul>
                </div>

                <div style="text-align: center; margin: 40px 0;">
                    <button onclick="showTab('databases')"
                        style="padding: 20px 40px; background: linear-gradient(135deg, #27ae60 0%, #229954 100%); color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);">
                        üêõ Start Learning: Databases ‚Üí
                    </button>
                </div>
            </div>
        </div>

        <!-- ETL vs ELT TAB -->
        <div id="etl-elt" class="tab-content active">
            <div class="section">
                <div class="section-title">
                    <span style="font-size: 48px;">üîÑ</span>
                    <span>ETL vs ELT</span>
                </div>

                <div class="concept-card" style="border-left-color: #e74c3c;">
                    <h3 style="color: #e74c3c; margin-bottom: 15px;">üì§ ETL: Extract, Transform, Load (Traditional)</h3>

                    <div class="info-box">
                        <h4>The Process:</h4>
                        <div style="text-align: center; font-size: 18px; line-height: 2.5; margin: 20px 0;">
                            <div style="color: #3498db;">1Ô∏è‚É£ <strong>Extract</strong> data from source systems</div>
                            <div style="font-size: 24px;">‚Üì</div>
                            <div style="color: #f39c12;">2Ô∏è‚É£ <strong>Transform</strong> data (clean, aggregate, join)
                            </div>
                            <div style="font-size: 24px;">‚Üì</div>
                            <div style="color: #27ae60;">3Ô∏è‚É£ <strong>Load</strong> into data warehouse</div>
                        </div>
                    </div>

                    <div class="success-box">
                        <h4>‚úÖ When to Use ETL:</h4>
                        <ul>
                            <li><strong>Limited storage/compute in warehouse</strong> - Transform before loading</li>
                            <li><strong>Complex transformations</strong> - Heavy processing before warehouse</li>
                            <li><strong>Data privacy/compliance</strong> - Clean sensitive data before loading</li>
                            <li><strong>On-premise systems</strong> - Traditional databases (Oracle, SQL Server)</li>
                        </ul>
                    </div>

                    <div class="warning-box">
                        <h4>‚ùå Drawbacks:</h4>
                        <ul>
                            <li>Slower - transformation happens before loading</li>
                            <li>Less flexible - hard to change transformations later</li>
                            <li>Bottleneck - ETL server can be a performance limit</li>
                        </ul>
                    </div>

                    <div class="code-block">
                        <span style="color: #95a5a6;">-- Example: ETL Process</span><br>
                        <span style="color: #e74c3c;">-- 1. Extract from source</span><br>
                        SELECT * FROM source_db.customers;<br>
                        <br>
                        <span style="color: #f39c12;">-- 2. Transform (clean, aggregate)</span><br>
                        cleaned_data = remove_duplicates(data)<br>
                        aggregated = group_by_region(cleaned_data)<br>
                        <br>
                        <span style="color: #27ae60;">-- 3. Load into warehouse</span><br>
                        INSERT INTO warehouse.dim_customer SELECT * FROM aggregated;
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #27ae60;">
                    <h3 style="color: #27ae60; margin-bottom: 15px;">üì• ELT: Extract, Load, Transform (Modern)</h3>

                    <div class="info-box">
                        <h4>The Process:</h4>
                        <div style="text-align: center; font-size: 18px; line-height: 2.5; margin: 20px 0;">
                            <div style="color: #3498db;">1Ô∏è‚É£ <strong>Extract</strong> data from source systems</div>
                            <div style="font-size: 24px;">‚Üì</div>
                            <div style="color: #27ae60;">2Ô∏è‚É£ <strong>Load</strong> raw data into warehouse</div>
                            <div style="font-size: 24px;">‚Üì</div>
                            <div style="color: #f39c12;">3Ô∏è‚É£ <strong>Transform</strong> using warehouse power (SQL)
                            </div>
                        </div>
                    </div>

                    <div class="success-box">
                        <h4>‚úÖ When to Use ELT:</h4>
                        <ul>
                            <li><strong>Cloud data warehouses</strong> - Snowflake, BigQuery, Redshift</li>
                            <li><strong>Massive compute power</strong> - Warehouse can handle transformations</li>
                            <li><strong>Flexibility needed</strong> - Easy to re-transform data</li>
                            <li><strong>Fast loading</strong> - Get data in quickly, transform later</li>
                            <li><strong>Modern approach</strong> - Industry standard for cloud</li>
                        </ul>
                    </div>

                    <div class="warning-box">
                        <h4>‚ö†Ô∏è Considerations:</h4>
                        <ul>
                            <li>Requires powerful warehouse (costs money)</li>
                            <li>Raw data stored (more storage needed)</li>
                            <li>Need good SQL skills for transformations</li>
                        </ul>
                    </div>

                    <div class="code-block">
                        <span style="color: #95a5a6;">-- Example: ELT Process</span><br>
                        <span style="color: #3498db;">-- 1. Extract from source</span><br>
                        SELECT * FROM source_db.customers;<br>
                        <br>
                        <span style="color: #27ae60;">-- 2. Load raw data into warehouse</span><br>
                        COPY INTO warehouse.raw_customers FROM source;<br>
                        <br>
                        <span style="color: #f39c12;">-- 3. Transform in warehouse (using SQL)</span><br>
                        CREATE TABLE warehouse.dim_customer AS<br>
                        SELECT DISTINCT customer_id, name, city<br>
                        FROM warehouse.raw_customers<br>
                        WHERE city IS NOT NULL;
                    </div>
                </div>

                <div class="comparison-grid">
                    <div class="comparison-box" style="border-left: 5px solid #e74c3c;">
                        <h4 style="color: #e74c3c;">ETL (Traditional)</h4>
                        <ul>
                            <li>Transform BEFORE load</li>
                            <li>On-premise friendly</li>
                            <li>Slower, less flexible</li>
                            <li>Tools: Informatica, SSIS</li>
                        </ul>
                    </div>
                    <div class="comparison-box" style="border-left: 5px solid #27ae60;">
                        <h4 style="color: #27ae60;">ELT (Modern)</h4>
                        <ul>
                            <li>Transform AFTER load</li>
                            <li>Cloud-native</li>
                            <li>Faster, more flexible</li>
                            <li>Tools: dbt, Fivetran</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- DATA WAREHOUSE TAB -->
        <div id="warehouse" class="tab-content">
            <div class="section">
                <div class="section-title">
                    <span style="font-size: 48px;">üè¢</span>
                    <span>Data Warehouse Architecture</span>
                </div>

                <div class="concept-card">
                    <h3 style="color: #3498db;">What is a Data Warehouse?</h3>
                    <p style="font-size: 16px; line-height: 1.8; margin: 15px 0;">
                        A <strong>data warehouse</strong> is a centralized repository that stores integrated data from
                        multiple sources,
                        optimized for analysis and reporting (not transactions).
                    </p>

                    <div class="info-box">
                        <h4>Key Characteristics:</h4>
                        <ul>
                            <li><strong>Subject-Oriented:</strong> Organized by business area (sales, customers,
                                products)</li>
                            <li><strong>Integrated:</strong> Data from multiple sources combined</li>
                            <li><strong>Time-Variant:</strong> Historical data preserved</li>
                            <li><strong>Non-Volatile:</strong> Data doesn't change once loaded</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #9b59b6;">
                    <h3 style="color: #9b59b6;">Data Warehouse Layers</h3>

                    <div class="success-box">
                        <h4>1Ô∏è‚É£ Staging Layer (Raw/Bronze)</h4>
                        <p><strong>Purpose:</strong> Land raw data from source systems</p>
                        <ul>
                            <li>Exact copy of source data</li>
                            <li>No transformations</li>
                            <li>Temporary storage</li>
                        </ul>
                        <div class="code-block" style="font-size: 13px;">
                            staging.raw_customers<br>
                            staging.raw_orders<br>
                            staging.raw_products
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>2Ô∏è‚É£ Integration Layer (Silver)</h4>
                        <p><strong>Purpose:</strong> Clean, standardize, and integrate data</p>
                        <ul>
                            <li>Remove duplicates</li>
                            <li>Fix data quality issues</li>
                            <li>Standardize formats</li>
                            <li>Combine from multiple sources</li>
                        </ul>
                        <div class="code-block" style="font-size: 13px;">
                            integration.customers_cleaned<br>
                            integration.orders_standardized<br>
                            integration.products_merged
                        </div>
                    </div>

                    <div class="warning-box">
                        <h4>3Ô∏è‚É£ Presentation Layer (Gold/Star Schema)</h4>
                        <p><strong>Purpose:</strong> Business-ready data for analysis</p>
                        <ul>
                            <li>Star schema (fact + dimensions)</li>
                            <li>Optimized for queries</li>
                            <li>Business-friendly names</li>
                            <li>Pre-aggregated metrics</li>
                        </ul>
                        <div class="code-block" style="font-size: 13px;">
                            presentation.fact_sales<br>
                            presentation.dim_customer<br>
                            presentation.dim_product<br>
                            presentation.dim_date
                        </div>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #e74c3c;">
                    <h3 style="color: #e74c3c;">Data Warehouse vs Data Lake vs Data Lakehouse</h3>

                    <table>
                        <tr>
                            <th>Aspect</th>
                            <th>Data Warehouse</th>
                            <th>Data Lake</th>
                            <th>Data Lakehouse</th>
                        </tr>
                        <tr>
                            <td><strong>Data Type</strong></td>
                            <td>Structured (tables)</td>
                            <td>All types (raw)</td>
                            <td>All types</td>
                        </tr>
                        <tr>
                            <td><strong>Schema</strong></td>
                            <td>Schema-on-write</td>
                            <td>Schema-on-read</td>
                            <td>Both</td>
                        </tr>
                        <tr>
                            <td><strong>Use Case</strong></td>
                            <td>BI, reporting</td>
                            <td>ML, data science</td>
                            <td>Both</td>
                        </tr>
                        <tr>
                            <td><strong>Cost</strong></td>
                            <td>Higher</td>
                            <td>Lower</td>
                            <td>Medium</td>
                        </tr>
                        <tr>
                            <td><strong>Examples</strong></td>
                            <td>Snowflake, Redshift</td>
                            <td>S3, Azure Data Lake</td>
                            <td>Databricks, Delta Lake</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <!-- STAGES TAB -->
        <div id="stages" class="tab-content">
            <div class="section">
                <div class="section-title">
                    <span style="font-size: 48px;">üìà</span>
                    <span>Data Engineering Stages</span>
                </div>

                <div class="concept-card">
                    <h3 style="color: #3498db;">The Data Engineering Lifecycle</h3>

                    <div style="text-align: center; font-size: 18px; line-height: 3; margin: 20px 0;">
                        <div style="color: #3498db;">1Ô∏è‚É£ <strong>Generation</strong> ‚Üí Data is created</div>
                        <div style="font-size: 24px;">‚Üì</div>
                        <div style="color: #9b59b6;">2Ô∏è‚É£ <strong>Ingestion</strong> ‚Üí Data is collected</div>
                        <div style="font-size: 24px;">‚Üì</div>
                        <div style="color: #f39c12;">3Ô∏è‚É£ <strong>Storage</strong> ‚Üí Data is stored</div>
                        <div style="font-size: 24px;">‚Üì</div>
                        <div style="color: #e74c3c;">4Ô∏è‚É£ <strong>Transformation</strong> ‚Üí Data is processed</div>
                        <div style="font-size: 24px;">‚Üì</div>
                        <div style="color: #27ae60;">5Ô∏è‚É£ <strong>Serving</strong> ‚Üí Data is used</div>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #3498db;">
                    <h4>1Ô∏è‚É£ Generation</h4>
                    <p><strong>What:</strong> Data is created by source systems</p>
                    <ul>
                        <li>Application databases (MySQL, PostgreSQL)</li>
                        <li>APIs (REST, GraphQL)</li>
                        <li>IoT devices, sensors</li>
                        <li>User interactions (clicks, purchases)</li>
                    </ul>
                </div>

                <div class="concept-card" style="border-left-color: #9b59b6;">
                    <h4>2Ô∏è‚É£ Ingestion</h4>
                    <p><strong>What:</strong> Moving data from sources to warehouse</p>
                    <div class="comparison-grid">
                        <div>
                            <strong style="color: #e74c3c;">Batch Ingestion</strong>
                            <ul>
                                <li>Scheduled (hourly, daily)</li>
                                <li>Large volumes</li>
                                <li>Tools: Fivetran, Airbyte</li>
                            </ul>
                        </div>
                        <div>
                            <strong style="color: #27ae60;">Streaming Ingestion</strong>
                            <ul>
                                <li>Real-time</li>
                                <li>Continuous flow</li>
                                <li>Tools: Kafka, Kinesis</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #f39c12;">
                    <h4>3Ô∏è‚É£ Storage</h4>
                    <p><strong>What:</strong> Where data lives</p>
                    <ul>
                        <li><strong>OLTP:</strong> Transactional databases (MySQL, PostgreSQL)</li>
                        <li><strong>OLAP:</strong> Analytical databases (Snowflake, BigQuery)</li>
                        <li><strong>Object Storage:</strong> Files (S3, Azure Blob)</li>
                        <li><strong>NoSQL:</strong> Document/Key-Value (MongoDB, Redis)</li>
                    </ul>
                </div>

                <div class="concept-card" style="border-left-color: #e74c3c;">
                    <h4>4Ô∏è‚É£ Transformation</h4>
                    <p><strong>What:</strong> Processing and preparing data</p>
                    <ul>
                        <li>Cleaning (remove nulls, fix errors)</li>
                        <li>Joining (combine tables)</li>
                        <li>Aggregating (sum, average, count)</li>
                        <li>Enriching (add calculated fields)</li>
                    </ul>
                    <p><strong>Tools:</strong> dbt, Spark, SQL</p>
                </div>

                <div class="concept-card" style="border-left-color: #27ae60;">
                    <h4>5Ô∏è‚É£ Serving</h4>
                    <p><strong>What:</strong> Making data available for use</p>
                    <ul>
                        <li><strong>BI Tools:</strong> Tableau, Power BI, Looker</li>
                        <li><strong>ML Models:</strong> Python, scikit-learn, TensorFlow</li>
                        <li><strong>APIs:</strong> REST endpoints for applications</li>
                        <li><strong>Reports:</strong> Scheduled dashboards, alerts</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- METRICS TAB -->
        <div id="metrics" class="tab-content">
            <div class="section">
                <div class="section-title">
                    <span style="font-size: 48px;">üìä</span>
                    <span>Common Metrics & KPIs</span>
                </div>

                <div class="concept-card">
                    <h3 style="color: #3498db;">What are Metrics vs KPIs?</h3>
                    <div class="comparison-grid">
                        <div class="comparison-box" style="border-left: 5px solid #3498db;">
                            <h4 style="color: #3498db;">Metrics</h4>
                            <p>Measurements of business activities</p>
                            <ul>
                                <li>Website visits</li>
                                <li>Number of orders</li>
                                <li>Page load time</li>
                            </ul>
                        </div>
                        <div class="comparison-box" style="border-left: 5px solid #e74c3c;">
                            <h4 style="color: #e74c3c;">KPIs (Key Performance Indicators)</h4>
                            <p>Critical metrics tied to business goals</p>
                            <ul>
                                <li>Monthly Recurring Revenue (MRR)</li>
                                <li>Customer Lifetime Value (CLV)</li>
                                <li>Conversion Rate</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #27ae60;">
                    <h3 style="color: #27ae60;">Common Business Metrics</h3>

                    <table>
                        <tr>
                            <th>Metric</th>
                            <th>Formula</th>
                            <th>What It Measures</th>
                        </tr>
                        <tr>
                            <td><strong>Revenue</strong></td>
                            <td>SUM(sales_amount)</td>
                            <td>Total money earned</td>
                        </tr>
                        <tr>
                            <td><strong>Profit</strong></td>
                            <td>Revenue - Cost</td>
                            <td>Money after expenses</td>
                        </tr>
                        <tr>
                            <td><strong>Profit Margin</strong></td>
                            <td>(Profit / Revenue) √ó 100</td>
                            <td>Profitability percentage</td>
                        </tr>
                        <tr>
                            <td><strong>AOV (Average Order Value)</strong></td>
                            <td>Revenue / Number of Orders</td>
                            <td>Average per transaction</td>
                        </tr>
                        <tr>
                            <td><strong>Conversion Rate</strong></td>
                            <td>(Conversions / Visitors) √ó 100</td>
                            <td>% who take action</td>
                        </tr>
                        <tr>
                            <td><strong>Churn Rate</strong></td>
                            <td>(Lost Customers / Total) √ó 100</td>
                            <td>Customer loss rate</td>
                        </tr>
                        <tr>
                            <td><strong>CAC (Customer Acquisition Cost)</strong></td>
                            <td>Marketing Spend / New Customers</td>
                            <td>Cost to acquire customer</td>
                        </tr>
                        <tr>
                            <td><strong>LTV (Lifetime Value)</strong></td>
                            <td>Avg Order Value √ó Purchase Frequency √ó Lifespan</td>
                            <td>Total customer value</td>
                        </tr>
                        <tr>
                            <td><strong>MRR (Monthly Recurring Revenue)</strong></td>
                            <td>SUM(monthly_subscriptions)</td>
                            <td>Predictable monthly income</td>
                        </tr>
                    </table>
                </div>

                <div class="concept-card" style="border-left-color: #9b59b6;">
                    <h3 style="color: #9b59b6;">Types of Metrics</h3>

                    <div class="success-box">
                        <h4>üìä Additive Metrics</h4>
                        <p>Can be summed across all dimensions</p>
                        <ul>
                            <li>Revenue (can sum by day, product, store)</li>
                            <li>Quantity sold</li>
                            <li>Number of orders</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <h4>üìà Semi-Additive Metrics</h4>
                        <p>Can sum across some dimensions, not all</p>
                        <ul>
                            <li>Account balance (can sum across accounts, NOT across time)</li>
                            <li>Inventory levels</li>
                        </ul>
                    </div>

                    <div class="warning-box">
                        <h4>üö´ Non-Additive Metrics</h4>
                        <p>Cannot be summed (must recalculate)</p>
                        <ul>
                            <li>Ratios (profit margin, conversion rate)</li>
                            <li>Averages (average order value)</li>
                            <li>Percentages</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- TERMINOLOGY TAB -->
        <div id="terminology" class="tab-content">
            <div class="section">
                <div class="section-title">
                    <span style="font-size: 48px;">üìö</span>
                    <span>Data Engineering Terminology</span>
                </div>

                <div class="concept-card">
                    <h3 style="color: #3498db;">Essential Terms</h3>

                    <div class="info-box">
                        <h4>üîë OLTP vs OLAP</h4>
                        <table>
                            <tr>
                                <th>OLTP (Online Transaction Processing)</th>
                                <th>OLAP (Online Analytical Processing)</th>
                            </tr>
                            <tr>
                                <td>Handles transactions (INSERT, UPDATE)</td>
                                <td>Handles analysis (SELECT, aggregate)</td>
                            </tr>
                            <tr>
                                <td>Normalized (3NF)</td>
                                <td>Denormalized (star schema)</td>
                            </tr>
                            <tr>
                                <td>Fast writes</td>
                                <td>Fast reads</td>
                            </tr>
                            <tr>
                                <td>Example: MySQL, PostgreSQL</td>
                                <td>Example: Snowflake, BigQuery</td>
                            </tr>
                        </table>
                    </div>

                    <div class="success-box">
                        <h4>üì¶ Data Modeling Terms</h4>
                        <ul>
                            <li><strong>Fact Table:</strong> Contains measurements/metrics (sales, clicks)</li>
                            <li><strong>Dimension Table:</strong> Contains context (customer, product, date)</li>
                            <li><strong>Star Schema:</strong> Fact table surrounded by dimensions</li>
                            <li><strong>Snowflake Schema:</strong> Normalized dimensions (dimensions have
                                sub-dimensions)</li>
                            <li><strong>Surrogate Key:</strong> Artificial primary key (product_key)</li>
                            <li><strong>Natural Key:</strong> Real-world identifier (product_id)</li>
                            <li><strong>SCD (Slowly Changing Dimension):</strong> Handling dimension changes over time
                            </li>
                            <li><strong>Grain:</strong> Level of detail in fact table (one row = one sale)</li>
                        </ul>
                    </div>

                    <div class="warning-box">
                        <h4>üîÑ Data Pipeline Terms</h4>
                        <ul>
                            <li><strong>Pipeline:</strong> Automated workflow moving/transforming data</li>
                            <li><strong>DAG (Directed Acyclic Graph):</strong> Workflow with dependencies</li>
                            <li><strong>Orchestration:</strong> Managing pipeline execution (Airflow, Prefect)</li>
                            <li><strong>Idempotent:</strong> Running multiple times = same result</li>
                            <li><strong>Incremental Load:</strong> Only load new/changed data</li>
                            <li><strong>Full Refresh:</strong> Reload all data</li>
                            <li><strong>CDC (Change Data Capture):</strong> Track changes in source</li>
                        </ul>
                    </div>

                    <div class="concept-card" style="border-left-color: #9b59b6;">
                        <h4>üìä Data Quality Terms</h4>
                        <ul>
                            <li><strong>Data Lineage:</strong> Track data from source to destination</li>
                            <li><strong>Data Catalog:</strong> Inventory of all data assets</li>
                            <li><strong>Schema Drift:</strong> Source schema changes unexpectedly</li>
                            <li><strong>Data Validation:</strong> Checking data meets rules</li>
                            <li><strong>Null Handling:</strong> Dealing with missing values</li>
                            <li><strong>Deduplication:</strong> Removing duplicate records</li>
                        </ul>
                    </div>

                    <div class="concept-card" style="border-left-color: #e74c3c;">
                        <h4>‚ö° Performance Terms</h4>
                        <ul>
                            <li><strong>Partitioning:</strong> Splitting table by column (e.g., by date)</li>
                            <li><strong>Clustering:</strong> Organizing data for faster queries</li>
                            <li><strong>Indexing:</strong> Creating lookup structures</li>
                            <li><strong>Materialized View:</strong> Pre-computed query results</li>
                            <li><strong>Query Optimization:</strong> Making queries faster</li>
                            <li><strong>Caching:</strong> Storing frequent query results</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- DATABASE TYPES TAB -->
        <div id="databases" class="tab-content">
            <div class="section">
                <div class="section-title">
                    <span style="font-size: 48px;">üíæ</span>
                    <span>Database Types</span>
                </div>

                <div class="concept-card">
                    <h3 style="color: #3498db;">What is a Database?</h3>
                    <p style="font-size: 16px; line-height: 1.8; margin: 15px 0;">
                        A <strong>database</strong> is an organized collection of data that can be easily accessed,
                        managed, and updated.
                    </p>
                </div>

                <div class="concept-card" style="border-left-color: #27ae60;">
                    <h3 style="color: #27ae60;">1Ô∏è‚É£ Relational Databases (SQL)</h3>

                    <div class="success-box">
                        <h4>What:</h4>
                        <p>Data stored in tables with rows and columns, relationships defined by keys</p>

                        <h4 style="margin-top: 15px;">Characteristics:</h4>
                        <ul>
                            <li><strong>ACID Compliant:</strong> Atomicity, Consistency, Isolation, Durability</li>
                            <li><strong>Schema-based:</strong> Structure defined before data entry</li>
                            <li><strong>SQL language:</strong> Structured Query Language</li>
                            <li><strong>Relationships:</strong> Foreign keys connect tables</li>
                        </ul>

                        <h4 style="margin-top: 15px;">When to Use:</h4>
                        <ul>
                            <li>Structured data with clear relationships</li>
                            <li>Need for ACID transactions (banking, e-commerce)</li>
                            <li>Complex queries with JOINs</li>
                            <li>Data integrity is critical</li>
                        </ul>

                        <h4 style="margin-top: 15px;">Examples:</h4>
                        <div class="comparison-grid">
                            <div><strong>MySQL:</strong> Open-source, web applications</div>
                            <div><strong>PostgreSQL:</strong> Advanced features, JSON support</div>
                            <div><strong>SQL Server:</strong> Microsoft, enterprise</div>
                            <div><strong>Oracle:</strong> Enterprise, high performance</div>
                        </div>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #e74c3c;">
                    <h3 style="color: #e74c3c;">2Ô∏è‚É£ NoSQL Databases (Not Only SQL)</h3>

                    <div class="warning-box">
                        <h4>What:</h4>
                        <p>Non-relational databases designed for flexibility, scalability, and speed</p>

                        <h4 style="margin-top: 15px;">Types of NoSQL:</h4>
                    </div>

                    <div class="comparison-grid">
                        <div class="comparison-box" style="border-left: 5px solid #3498db;">
                            <h4 style="color: #3498db;">Document Stores</h4>
                            <p><strong>Structure:</strong> JSON-like documents</p>
                            <p><strong>Use Case:</strong> Content management, user profiles</p>
                            <p><strong>Examples:</strong></p>
                            <ul>
                                <li>MongoDB</li>
                                <li>CouchDB</li>
                                <li>Firestore</li>
                            </ul>
                            <div class="code-block" style="font-size: 12px;">
                                {<br>
                                "customer_id": 123,<br>
                                "name": "John",<br>
                                "orders": [...]<br>
                                }
                            </div>
                        </div>

                        <div class="comparison-box" style="border-left: 5px solid #27ae60;">
                            <h4 style="color: #27ae60;">Key-Value Stores</h4>
                            <p><strong>Structure:</strong> Simple key ‚Üí value pairs</p>
                            <p><strong>Use Case:</strong> Caching, session storage</p>
                            <p><strong>Examples:</strong></p>
                            <ul>
                                <li>Redis</li>
                                <li>DynamoDB</li>
                                <li>Memcached</li>
                            </ul>
                            <div class="code-block" style="font-size: 12px;">
                                user:123 ‚Üí {"name": "John"}<br>
                                session:abc ‚Üí {"logged_in": true}
                            </div>
                        </div>

                        <div class="comparison-box" style="border-left: 5px solid #f39c12;">
                            <h4 style="color: #f39c12;">Column-Family Stores</h4>
                            <p><strong>Structure:</strong> Columns grouped into families</p>
                            <p><strong>Use Case:</strong> Time-series, analytics</p>
                            <p><strong>Examples:</strong></p>
                            <ul>
                                <li>Cassandra</li>
                                <li>HBase</li>
                                <li>BigTable</li>
                            </ul>
                        </div>

                        <div class="comparison-box" style="border-left: 5px solid #9b59b6;">
                            <h4 style="color: #9b59b6;">Graph Databases</h4>
                            <p><strong>Structure:</strong> Nodes and relationships</p>
                            <p><strong>Use Case:</strong> Social networks, recommendations</p>
                            <p><strong>Examples:</strong></p>
                            <ul>
                                <li>Neo4j</li>
                                <li>Amazon Neptune</li>
                                <li>ArangoDB</li>
                            </ul>
                        </div>
                    </div>

                    <div class="success-box">
                        <h4>When to Use NoSQL:</h4>
                        <ul>
                            <li>Unstructured or semi-structured data</li>
                            <li>Need for horizontal scaling</li>
                            <li>Flexible schema (data structure changes often)</li>
                            <li>High-speed reads/writes</li>
                            <li>Large volumes of data</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #9b59b6;">
                    <h3 style="color: #9b59b6;">3Ô∏è‚É£ NewSQL Databases</h3>

                    <div class="info-box">
                        <h4>What:</h4>
                        <p>Modern relational databases with NoSQL scalability</p>

                        <h4 style="margin-top: 15px;">Characteristics:</h4>
                        <ul>
                            <li>SQL interface (like traditional RDBMS)</li>
                            <li>Horizontal scalability (like NoSQL)</li>
                            <li>ACID transactions</li>
                            <li>Distributed architecture</li>
                        </ul>

                        <h4 style="margin-top: 15px;">Examples:</h4>
                        <ul>
                            <li><strong>CockroachDB:</strong> Distributed SQL</li>
                            <li><strong>Google Spanner:</strong> Global distribution</li>
                            <li><strong>VoltDB:</strong> In-memory transactions</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #e74c3c;">
                    <h3 style="color: #e74c3c;">Comparison Table</h3>

                    <table>
                        <tr>
                            <th>Aspect</th>
                            <th>Relational (SQL)</th>
                            <th>NoSQL</th>
                            <th>NewSQL</th>
                        </tr>
                        <tr>
                            <td><strong>Schema</strong></td>
                            <td>Fixed, predefined</td>
                            <td>Flexible, dynamic</td>
                            <td>Fixed, predefined</td>
                        </tr>
                        <tr>
                            <td><strong>Scaling</strong></td>
                            <td>Vertical (bigger server)</td>
                            <td>Horizontal (more servers)</td>
                            <td>Horizontal</td>
                        </tr>
                        <tr>
                            <td><strong>Transactions</strong></td>
                            <td>ACID</td>
                            <td>Eventually consistent</td>
                            <td>ACID</td>
                        </tr>
                        <tr>
                            <td><strong>Query Language</strong></td>
                            <td>SQL</td>
                            <td>Varies</td>
                            <td>SQL</td>
                        </tr>
                        <tr>
                            <td><strong>Best For</strong></td>
                            <td>Structured data, complex queries</td>
                            <td>Unstructured data, high volume</td>
                            <td>Both</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <!-- DATA LAKE & MART TAB -->
        <div id="lake-mart" class="tab-content">
            <div class="section">
                <div class="section-title">
                    <span style="font-size: 48px;">üåä</span>
                    <span>Data Lake vs Data Mart</span>
                </div>

                <div class="concept-card" style="border-left-color: #3498db;">
                    <h3 style="color: #3498db;">üåä Data Lake</h3>

                    <div class="info-box">
                        <h4>What is it?</h4>
                        <p style="font-size: 16px; line-height: 1.8;">
                            A <strong>data lake</strong> is a centralized repository that stores ALL data in its RAW,
                            NATIVE format
                            (structured, semi-structured, unstructured) at any scale.
                        </p>

                        <h4 style="margin-top: 20px;">Characteristics:</h4>
                        <ul>
                            <li><strong>Schema-on-read:</strong> Define structure when reading data</li>
                            <li><strong>All data types:</strong> CSV, JSON, images, videos, logs</li>
                            <li><strong>Low cost:</strong> Cheap object storage (S3, Azure Blob)</li>
                            <li><strong>Flexible:</strong> Store now, decide how to use later</li>
                            <li><strong>Scale:</strong> Petabytes of data</li>
                        </ul>

                        <h4 style="margin-top: 20px;">Use Cases:</h4>
                        <ul>
                            <li>Machine learning (need raw data)</li>
                            <li>Data science exploration</li>
                            <li>Archiving historical data</li>
                            <li>IoT sensor data</li>
                            <li>Log files, clickstreams</li>
                        </ul>

                        <h4 style="margin-top: 20px;">Examples:</h4>
                        <div class="comparison-grid">
                            <div><strong>AWS S3:</strong> Object storage</div>
                            <div><strong>Azure Data Lake:</strong> Microsoft cloud</div>
                            <div><strong>Google Cloud Storage:</strong> GCP</div>
                            <div><strong>Hadoop HDFS:</strong> On-premise</div>
                        </div>
                    </div>

                    <div class="warning-box">
                        <h4>‚ö†Ô∏è Risk: Data Swamp</h4>
                        <p>Without proper governance, a data lake becomes a "data swamp" - unorganized, undocumented
                            data that nobody can use!</p>
                        <p><strong>Prevention:</strong></p>
                        <ul>
                            <li>Catalog all data</li>
                            <li>Add metadata</li>
                            <li>Implement data quality checks</li>
                            <li>Define access controls</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #27ae60;">
                    <h3 style="color: #27ae60;">üè™ Data Mart</h3>

                    <div class="success-box">
                        <h4>What is it?</h4>
                        <p style="font-size: 16px; line-height: 1.8;">
                            A <strong>data mart</strong> is a subset of a data warehouse focused on a SPECIFIC business
                            area or department.
                        </p>

                        <h4 style="margin-top: 20px;">Characteristics:</h4>
                        <ul>
                            <li><strong>Subject-specific:</strong> Sales, Marketing, Finance</li>
                            <li><strong>Smaller scope:</strong> One department vs entire company</li>
                            <li><strong>Optimized:</strong> Fast queries for specific use case</li>
                            <li><strong>Business-ready:</strong> Clean, transformed data</li>
                            <li><strong>Star schema:</strong> Fact + dimension tables</li>
                        </ul>

                        <h4 style="margin-top: 20px;">Types:</h4>
                        <div class="comparison-grid">
                            <div>
                                <strong style="color: #3498db;">Dependent Data Mart</strong>
                                <p>Created from central data warehouse</p>
                            </div>
                            <div>
                                <strong style="color: #e74c3c;">Independent Data Mart</strong>
                                <p>Built directly from source systems</p>
                            </div>
                        </div>

                        <h4 style="margin-top: 20px;">Examples:</h4>
                        <ul>
                            <li><strong>Sales Mart:</strong> Revenue, orders, customers</li>
                            <li><strong>Marketing Mart:</strong> Campaigns, leads, conversions</li>
                            <li><strong>Finance Mart:</strong> Expenses, budgets, forecasts</li>
                            <li><strong>HR Mart:</strong> Employees, payroll, performance</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #9b59b6;">
                    <h3 style="color: #9b59b6;">üìä Comparison: Database vs Warehouse vs Lake vs Mart</h3>

                    <table>
                        <tr>
                            <th>Aspect</th>
                            <th>Database</th>
                            <th>Data Warehouse</th>
                            <th>Data Lake</th>
                            <th>Data Mart</th>
                        </tr>
                        <tr>
                            <td><strong>Purpose</strong></td>
                            <td>Run applications</td>
                            <td>Analysis & reporting</td>
                            <td>Store all data</td>
                            <td>Dept-specific analysis</td>
                        </tr>
                        <tr>
                            <td><strong>Data Type</strong></td>
                            <td>Structured</td>
                            <td>Structured</td>
                            <td>All types</td>
                            <td>Structured</td>
                        </tr>
                        <tr>
                            <td><strong>Schema</strong></td>
                            <td>Schema-on-write</td>
                            <td>Schema-on-write</td>
                            <td>Schema-on-read</td>
                            <td>Schema-on-write</td>
                        </tr>
                        <tr>
                            <td><strong>Users</strong></td>
                            <td>Applications</td>
                            <td>Analysts, executives</td>
                            <td>Data scientists</td>
                            <td>Dept teams</td>
                        </tr>
                        <tr>
                            <td><strong>Scope</strong></td>
                            <td>Single application</td>
                            <td>Entire organization</td>
                            <td>Entire organization</td>
                            <td>Single department</td>
                        </tr>
                        <tr>
                            <td><strong>Processing</strong></td>
                            <td>OLTP (transactions)</td>
                            <td>OLAP (analytics)</td>
                            <td>Batch/Stream</td>
                            <td>OLAP (analytics)</td>
                        </tr>
                        <tr>
                            <td><strong>Cost</strong></td>
                            <td>Medium</td>
                            <td>High</td>
                            <td>Low</td>
                            <td>Low-Medium</td>
                        </tr>
                    </table>
                </div>

                <div class="concept-card" style="border-left-color: #e74c3c;">
                    <h3 style="color: #e74c3c;">üîÑ How They Work Together</h3>

                    <div style="text-align: center; font-size: 16px; line-height: 3; margin: 20px 0;">
                        <div style="color: #3498db;"><strong>Databases</strong> (OLTP - Applications)</div>
                        <div style="font-size: 24px;">‚Üì</div>
                        <div style="color: #9b59b6;"><strong>Data Lake</strong> (Raw storage)</div>
                        <div style="font-size: 24px;">‚Üì</div>
                        <div style="color: #27ae60;"><strong>Data Warehouse</strong> (Cleaned, integrated)</div>
                        <div style="font-size: 24px;">‚Üì</div>
                        <div style="color: #f39c12;"><strong>Data Marts</strong> (Dept-specific)</div>
                        <div style="font-size: 24px;">‚Üì</div>
                        <div style="color: #e74c3c;"><strong>BI Tools</strong> (Reports, dashboards)</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ARCHITECTURE TAB -->
        <div id="architecture" class="tab-content">
            <div class="section">
                <div class="section-title">
                    <span style="font-size: 48px;">üèóÔ∏è</span>
                    <span>System Architecture & Query Flow</span>
                </div>

                <div class="success-box">
                    <h3 style="color: #27ae60; text-align: center;">üéØ Where Does Data Live When You Query It?</h3>
                    <p style="font-size: 18px; text-align: center; margin-top: 15px;">
                        <strong>Answer: Data lives REMOTELY in the cloud (Data Warehouse), NOT locally on your
                            computer!</strong>
                    </p>
                </div>

                <div class="concept-card" style="border-left-color: #3498db;">
                    <h3 style="color: #3498db;">üìç Where Data Physically Lives</h3>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <div
                            style="background: #e8f8f5; padding: 20px; border-radius: 10px; border: 3px solid #27ae60;">
                            <h4 style="color: #27ae60; text-align: center;">‚úÖ REMOTE (Cloud)</h4>
                            <div style="margin-top: 15px;">
                                <div
                                    style="background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #27ae60;">
                                    <strong>Data Lake (S3)</strong>
                                    <p style="font-size: 14px; margin: 5px 0;">Raw files stored in cloud</p>
                                </div>
                                <div
                                    style="background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #27ae60;">
                                    <strong>Data Warehouse (Snowflake)</strong>
                                    <p style="font-size: 14px; margin: 5px 0;">Star schema tables in cloud</p>
                                    <p style="font-size: 12px; color: #e74c3c; margin: 5px 0;"><strong>‚≠ê QUERIES RUN
                                            HERE!</strong></p>
                                </div>
                                <div
                                    style="background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #27ae60;">
                                    <strong>Data Mart</strong>
                                    <p style="font-size: 14px; margin: 5px 0;">Subset in cloud warehouse</p>
                                    <p style="font-size: 12px; color: #e74c3c; margin: 5px 0;"><strong>‚≠ê QUERIES RUN
                                            HERE TOO!</strong></p>
                                </div>
                            </div>
                        </div>

                        <div
                            style="background: #ffebee; padding: 20px; border-radius: 10px; border: 3px solid #e74c3c;">
                            <h4 style="color: #e74c3c; text-align: center;">‚ùå LOCAL (Your Computer)</h4>
                            <div style="margin-top: 15px;">
                                <div
                                    style="background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #e74c3c;">
                                    <strong>BI Tool (Tableau, Power BI)</strong>
                                    <p style="font-size: 14px; margin: 5px 0;">Just the interface/software</p>
                                </div>
                                <div
                                    style="background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #e74c3c;">
                                    <strong>Connection Settings</strong>
                                    <p style="font-size: 14px; margin: 5px 0;">Warehouse URL, credentials</p>
                                </div>
                                <div
                                    style="background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #e74c3c;">
                                    <strong>Query Results (Cached)</strong>
                                    <p style="font-size: 14px; margin: 5px 0;">Temporary, small subset</p>
                                </div>
                                <div
                                    style="background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #95a5a6;">
                                    <strong style="text-decoration: line-through;">Actual Data</strong>
                                    <p style="font-size: 14px; margin: 5px 0; color: #e74c3c;"><strong>NOT stored
                                            here!</strong></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #9b59b6;">
                    <h3 style="color: #9b59b6;">üîÑ Complete Query Flow</h3>

                    <div
                        style="background: linear-gradient(135deg, #f8f9fa 0%, #e8f4f8 100%); padding: 30px; border-radius: 10px; margin: 20px 0;">
                        <div
                            style="display: flex; align-items: center; justify-content: space-between; margin: 20px 0;">
                            <div style="flex: 1; text-align: center;">
                                <div
                                    style="background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border: 3px solid #3498db;">
                                    <div style="font-size: 36px; margin-bottom: 10px;">üíª</div>
                                    <strong style="color: #3498db;">Your Computer</strong>
                                    <p style="font-size: 14px; margin: 10px 0;">Tableau/Power BI</p>
                                    <p style="font-size: 12px; color: #7f8c8d;">(LOCAL)</p>
                                </div>
                            </div>

                            <div style="flex: 0 0 100px; text-align: center;">
                                <div style="font-size: 24px; color: #27ae60;">‚Üí</div>
                                <p style="font-size: 12px; color: #27ae60; margin: 5px 0;"><strong>SQL Query</strong>
                                </p>
                                <div class="code-block" style="font-size: 10px; margin: 5px 0;">
                                    SELECT SUM(amount)<br>
                                    FROM fact_sales
                                </div>
                            </div>

                            <div style="flex: 1; text-align: center;">
                                <div
                                    style="background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border: 3px solid #27ae60;">
                                    <div style="font-size: 36px; margin-bottom: 10px;">‚òÅÔ∏è</div>
                                    <strong style="color: #27ae60;">Cloud Warehouse</strong>
                                    <p style="font-size: 14px; margin: 10px 0;">Snowflake/BigQuery</p>
                                    <p style="font-size: 12px; color: #7f8c8d;">(REMOTE)</p>
                                    <p style="font-size: 11px; color: #e74c3c; margin-top: 10px;"><strong>‚≠ê Data stored
                                            here!</strong></p>
                                </div>
                            </div>
                        </div>

                        <div style="text-align: center; margin: 30px 0;">
                            <div style="font-size: 24px; color: #3498db;">‚Üì</div>
                            <p style="font-size: 14px; color: #2c3e50; margin: 10px 0;">
                                <strong>Warehouse processes query on billions of rows</strong>
                            </p>
                            <div style="font-size: 24px; color: #3498db;">‚Üì</div>
                        </div>

                        <div
                            style="display: flex; align-items: center; justify-content: space-between; margin: 20px 0;">
                            <div style="flex: 1; text-align: center;">
                                <div
                                    style="background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border: 3px solid #3498db;">
                                    <div style="font-size: 36px; margin-bottom: 10px;">üìä</div>
                                    <strong style="color: #3498db;">Your Computer</strong>
                                    <p style="font-size: 14px; margin: 10px 0;">Displays Results</p>
                                    <p style="font-size: 12px; color: #7f8c8d;">(LOCAL)</p>
                                </div>
                            </div>

                            <div style="flex: 0 0 100px; text-align: center;">
                                <div style="font-size: 24px; color: #e74c3c;">‚Üê</div>
                                <p style="font-size: 12px; color: #e74c3c; margin: 5px 0;"><strong>Results</strong></p>
                                <div class="code-block" style="font-size: 10px; margin: 5px 0;">
                                    Total: $50,000
                                </div>
                                <p style="font-size: 10px; color: #7f8c8d;">(Only 1 row returned)</p>
                            </div>

                            <div style="flex: 1; text-align: center;">
                                <div
                                    style="background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border: 3px solid #27ae60;">
                                    <div style="font-size: 36px; margin-bottom: 10px;">‚òÅÔ∏è</div>
                                    <strong style="color: #27ae60;">Cloud Warehouse</strong>
                                    <p style="font-size: 14px; margin: 10px 0;">Sends Results</p>
                                    <p style="font-size: 12px; color: #7f8c8d;">(REMOTE)</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="warning-box">
                        <h4>üîë Key Point:</h4>
                        <p style="font-size: 16px; line-height: 1.8;">
                            The warehouse might process <strong>1 billion rows</strong> in the cloud, but only sends
                            back <strong>1 row</strong> (the aggregated result) to your computer. This is why you can
                            query massive datasets without filling up your hard drive!
                        </p>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #f39c12;">
                    <h3 style="color: #f39c12;">üì¶ Real-World Example</h3>

                    <div class="comparison-grid">
                        <div>
                            <h4 style="color: #3498db;">Your Computer (Local)</h4>
                            <div class="code-block" style="text-align: left;">
                                Tableau Desktop: 500 MB<br>
                                Connection settings: 1 KB<br>
                                Cached results: 100 MB<br>
                                ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<br>
                                <strong>Total: ~600 MB</strong>
                            </div>
                        </div>

                        <div>
                            <h4 style="color: #27ae60;">Cloud Warehouse (Remote)</h4>
                            <div class="code-block" style="text-align: left;">
                                fact_sales: 5 TB<br>
                                dim_customer: 10 GB<br>
                                dim_product: 500 MB<br>
                                dim_date: 1 MB<br>
                                ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<br>
                                <strong>Total: ~5 TB</strong>
                            </div>
                        </div>
                    </div>

                    <div class="success-box" style="margin-top: 20px;">
                        <h4>üí° Why This Matters:</h4>
                        <ul>
                            <li><strong>Scalability:</strong> Store petabytes without expensive local hardware</li>
                            <li><strong>Performance:</strong> Cloud servers process data faster than laptops</li>
                            <li><strong>Collaboration:</strong> Multiple analysts query same data simultaneously</li>
                            <li><strong>Cost:</strong> Pay for cloud storage/compute, not local infrastructure</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card" style="border-left-color: #e74c3c;">
                    <h3 style="color: #e74c3c;">üé§ Interview Answer</h3>

                    <div class="info-box">
                        <h4>When asked: "Where is the data stored when you run queries?"</h4>
                        <div
                            style="background: #fff; padding: 20px; margin: 15px 0; border-left: 4px solid #3498db; border-radius: 5px;">
                            <p style="font-style: italic; line-height: 1.8;">
                                "The data is stored remotely in the cloud data warehouse - for example, in Snowflake or
                                BigQuery. When an analyst runs a query from Tableau, the query is sent to the warehouse,
                                executed there on the distributed cloud infrastructure, and only the aggregated results
                                are sent back to the analyst's computer.
                                <br><br>
                                For instance, if we're querying 1 billion rows to calculate total revenue, all 1 billion
                                rows stay in the warehouse. The warehouse processes them and returns just one number -
                                the total. This allows us to store and query petabytes of data without needing powerful
                                local hardware."
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- REAL WORLD TAB -->
        <div id="real-world" class="tab-content">
            <div class="section">
                <div class="section-title">
                    <span style="font-size: 48px;">üõí</span>
                    <span>Follow Luke: A Data Engineer's Journey</span>
                </div>

                <!-- PROGRESS TIMELINE -->
                <div class="timeline-container">
                    <div class="timeline-step active">
                        <div class="step-circle">1</div>
                        <div class="step-label">Week 1<br>Design</div>
                        <div class="step-line"></div>
                    </div>
                    <div class="timeline-step active">
                        <div class="step-circle">2</div>
                        <div class="step-label">Week 4<br>Pipeline</div>
                        <div class="step-line"></div>
                    </div>
                    <div class="timeline-step active">
                        <div class="step-circle">3</div>
                        <div class="step-label">Week 6<br>Modeling</div>
                        <div class="step-line"></div>
                    </div>
                    <div class="timeline-step active">
                        <div class="step-circle">4</div>
                        <div class="step-label">Week 9<br>Results</div>
                        <div class="step-line"></div>
                    </div>
                    <div class="timeline-step">
                        <div class="step-circle">5</div>
                        <div class="step-label">Phase 2<br>Scale</div>
                    </div>
                </div>

                <div class="concept-card">
                    <h3 style="color: #3498db;">üë®‚Äçüíª Meet Luke</h3>
                    <p style="font-size: 16px; margin: 15px 0;">
                        <strong>Luke Martinez</strong> is a data engineer at ShopCo, a growing e-commerce company.
                        His task is to <strong>build a complete analytics platform</strong> that will transform how the
                        business makes decisions.
                    </p>
                    <p style="font-size: 16px;">
                        Follow along as Luke builds a <strong>self-service data warehouse</strong> using AWS S3,
                        Snowflake, Fivetran, dbt, and Tableau to deliver real-time insights.
                    </p>
                </div>

                <div class="concept-card" style="border-left-color: #e74c3c;">
                    <h3 style="color: #e74c3c;">üìÖ Day 1: The Problem</h3>
                    <div class="info-box">
                        <h4>Stakeholder Pain Points:</h4>
                        <ul>
                            <li><strong>Sarah (VP Sales):</strong> "I need revenue numbers for last month, but it takes
                                2 days to get them."</li>
                            <li><strong>Mike (Marketing):</strong> "I can't get customer lists for my campaigns fast
                                enough."</li>
                            <li><strong>Emma (Product):</strong> "Data is scattered everywhere. I don't know what's
                                selling."</li>
                        </ul>
                    </div>
                </div>

                <div class="section-title" style="font-size: 32px; margin-top: 40px;">üìÖ Week 1: Architecture Design
                </div>

                <div class="concept-card" style="border-left-color: #27ae60;">
                    <h3 style="color: #27ae60;">Decisions & Trade-offs</h3>

                    <div class="comparison-grid">
                        <div class="comparison-box" style="border-left: 5px solid #27ae60;">
                            <h4 style="color: #27ae60;">Decision 1: Data Lake?</h4>
                            <p><strong>Option A:</strong> Direct to Warehouse (Simple)</p>
                            <p><strong>Option B:</strong> Lake + Warehouse (Complex)</p>
                            <p style="margin-top: 10px;"><strong>‚úÖ Choice: Option B (Data Lake)</strong></p>
                            <p style="font-size: 12px;">Reason: Need cheap storage for logs/images and disaster
                                recovery.</p>
                        </div>
                        <div class="comparison-box" style="border-left: 5px solid #3498db;">
                            <h4 style="color: #3498db;">Decision 2: Tooling?</h4>
                            <p><strong>Warehouse:</strong> Snowflake (Scalable, easy)</p>
                            <p><strong>Ingestion:</strong> Fivetran (Automated)</p>
                            <p><strong>BI Tool:</strong> Tableau (User-friendly)</p>
                        </div>
                    </div>

                    <div class="success-box" style="margin-top: 20px;">
                        <h4>üèóÔ∏è Final Architecture:</h4>
                        <div style="text-align: center; font-size: 16px; line-height: 2;">
                            Sources (MySQL, API) ‚Üí <strong style="color: #f39c12;">Fivetran</strong> ‚Üí
                            <strong style="color: #e67e22;">S3 (Data Lake)</strong> ‚Üí
                            <strong style="color: #3498db;">Snowflake (Warehouse)</strong> ‚Üí
                            <strong style="color: #9b59b6;">Tableau (BI)</strong>
                        </div>

                        <div style="margin-top: 30px; background: white; padding: 20px; border-radius: 10px;">
                            <h4 style="text-align: center; margin-bottom: 10px;">üìä Architecture Diagram</h4>
                            <div class="mermaid">
                                flowchart LR
                                MySQL[(MySQL Orders)] --> Fivetran
                                API[(Salesforce API)] --> Fivetran
                                Logs[(S3 Logs)] --> Fivetran

                                Fivetran --> S3[(AWS S3 Data Lake)]
                                S3 --> Snowflake[(Snowflake DW)]

                                Snowflake --> Bronze
                                Bronze --> Silver
                                Silver --> Gold

                                Gold --> Tableau[(Tableau Dashboard)]

                                style S3 fill:#e67e22,stroke:#d35400,color:white
                                style Snowflake fill:#3498db,stroke:#2980b9,color:white
                                style Tableau fill:#9b59b6,stroke:#8e44ad,color:white
                                style Fivetran fill:#f1c40f,stroke:#f39c12,color:white
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-title" style="font-size: 32px; margin-top: 40px;">üìÖ Weeks 2-4: Building the
                    Pipeline</div>

                <div class="concept-card" style="border-left-color: #f39c12;">
                    <h3 style="color: #f39c12;">Step 1: Ingestion (ELT)</h3>
                    <p>Luke uses Fivetran to automate data extraction. Hover to see the <strong>Configuration
                            Code</strong> that engineers write to set this up!</p>

                    <div
                        style="margin: 15px 0; padding: 10px; background: #fdfefe; border: 1px dashed #bdc3c7; border-radius: 5px;">
                        <strong>Connects to:</strong>
                        <span class="tooltip">MySQL
                            <span class="tooltip-text">
                                // tf_fivetran_mysql_config.json
                                {
                                "host": "db.prod.mysql.com",
                                "port": 3306,
                                "user": "fivetran_user",
                                "password": "${SECRETS.MYSQL_PASS}",
                                "database": "shopco_prod",
                                "update_method": "LOG_BASED"
                                }
                            </span>
                        </span>,
                        <span class="tooltip">Salesforce API
                            <span class="tooltip-text">
                                // tf_fivetran_salesforce.json
                                {
                                "auth_type": "OAuth",
                                "client_id": "3MVG9...",
                                "client_secret": "${SECRETS.SF_SECRET}",
                                "objects": ["Account", "Opportunity", "Lead"],
                                "sync_frequency": "60_MIN"
                                }
                            </span>
                        </span>, and
                        <span class="tooltip">S3 Logs
                            <span class="tooltip-text">
                                // tf_fivetran_s3_logs.json
                                {
                                "bucket": "s3://shopco-raw-logs",
                                "prefix": "app-events/",
                                "file_type": "JSON",
                                "compression": "GZIP",
                                "role_arn": "arn:aws:iam::123:role/FivetranAccess"
                                }
                            </span>
                        </span>.
                    </div>

                    <div class="code-block">
                        <span style="color: #95a5a6;">-- Data flowing into S3 (Data Lake)</span><br>
                        [10:00 AM] Extracting from MySQL... 10,000 rows<br>
                        [10:05 AM] Loading to S3... Complete
                    </div>

                    <!-- NEW: PUSH VS PULL EXPLANATION -->
                    <div class="info-box"
                        style="margin-top: 15px; border-left-color: #9b59b6; background: linear-gradient(135deg, #f4ecf7 0%, #e8daf2 100%);">
                        <h4 style="color: #8e44ad; margin-bottom: 10px;">ü§î Question: "How does the source know where to
                            send data?"</h4>
                        <p style="font-size: 14px; margin-bottom: 10px;">Great question! Usually, the source (e.g.,
                            MySQL) <strong>DOESN'T KNOW</strong>. It just sits there. The "Pipeline" does the moving.
                            There are two ways this happens:</p>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div style="background: white; padding: 15px; border-radius: 8px;">
                                <strong style="color: #2c3e50;">1. PULL (Polling) üöú</strong>
                                <p style="font-size: 13px; color: #7f8c8d; margin-top: 5px;">
                                    The Pipeline (Fivetran) knocks on the door every hour.<br>
                                    <em>"Do you have new data?"</em><br>
                                    <br>
                                    <strong>Most Common.</strong> The source stays passive. Fivetran needs a
                                    username/password to enter and check the logs.
                                </p>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px;">
                                <strong style="color: #e67e22;">2. PUSH (Webhooks) üì®</strong>
                                <p style="font-size: 13px; color: #7f8c8d; margin-top: 5px;">
                                    The Source (e.g., Stripe) actively shouts when an event happens.<br>
                                    <em>"New Payment! Sending to URL..."</em><br>
                                    <br>
                                    <strong>Real-time.</strong> The source is configured with a specific "Destination
                                    URL" (Webhook) to send data to.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- NEW: TOOLS OF THE TRADE & API VISUALIZATION -->
                <div style="margin-top: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">

                    <!-- LEFT: TOOLS REGISTRY -->
                    <div class="concept-card" style="margin: 0; border-left-color: #34495e;">
                        <h4 style="color: #2c3e50; margin-bottom: 10px;">üõ†Ô∏è Tools of the Trade</h4>
                        <p style="font-size: 13px; margin-bottom: 15px;">Hover to see what they provide:</p>

                        <ul style="line-height: 2;">
                            <li>
                                <span class="tooltip left"><strong>Fivetran</strong>
                                    <span class="tooltip-text">üöö <strong>Managed ELT (Batch)</strong><br>Standard for
                                        data warehouses. Zero-coding setup. Pulls data every 15m-24h. Expensive but
                                        reliable.</span>
                                </span>
                            </li>
                            <li>
                                <span class="tooltip left"><strong>Airbyte</strong>
                                    <span class="tooltip-text">ü¶ú <strong>Open Source ELT (Batch)</strong><br>Free
                                        (self-hosted) alternative to Fivetran. Huge text library. Good for custom
                                        connectors.</span>
                                </span>
                            </li>
                            <li>
                                <span class="tooltip left"><strong>Kafka</strong>
                                    <span class="tooltip-text">‚ö° <strong>Event Streaming (Real-time)</strong><br>"The
                                        Central Nervous System". Handles massive throughput (millions of events/sec).
                                        Used for immediate action.</span>
                                </span>
                            </li>
                            <li>
                                <span class="tooltip left"><strong>AWS Kinesis</strong>
                                    <span class="tooltip-text">üåä <strong>Managed Streaming (Real-time)</strong><br>AWS
                                        version of Kafka. Easier to manage but locked into AWS. Great for ingestion
                                        logs.</span>
                                </span>
                            </li>
                        </ul>
                    </div>

                    <!-- RIGHT: WHAT DOES A "PUSH API" LOOK LIKE? -->
                    <div class="concept-card" style="margin: 0; border-left-color: #e67e22;">
                        <h4 style="color: #d35400; margin-bottom: 10px;">üíª Code: The "Push" API</h4>
                        <p style="font-size: 13px; margin-bottom: 10px;">When Stripe "Pushes" data, <strong>YOU</strong>
                            must write the code to catch it. Example (Python):</p>

                        <div class="code-block" style="font-size: 11px; padding: 10px; margin: 0;">
                            <span style="color: #e74c3c;">@app.route</span>(<span class="sql-str">'/webhook'</span>,
                            methods=[<span class="sql-str">'POST'</span>])<br>
                            <span style="color: #aeaeae;">def</span> <span
                                style="color: #f1c40f;">receive_payment</span>():<br>
                            &nbsp;&nbsp;<span style="color: #27ae60;"># 1. Catch the JSON data</span><br>
                            &nbsp;&nbsp;data = request.json<br>
                            &nbsp;&nbsp;<br>
                            &nbsp;&nbsp;<span style="color: #27ae60;"># 2. Process it immediately</span><br>
                            &nbsp;&nbsp;print(<span class="sql-str">f"Received $</span>{data['amount']}<span
                                class="sql-str">"</span>)<br>
                            &nbsp;&nbsp;<br>
                            &nbsp;&nbsp;<span style="color: #27ae60;"># 3. Say "Thanks!"</span><br>
                            &nbsp;&nbsp;<span style="color: #aeaeae;">return</span> jsonify(status=<span
                                class="sql-str">"success"</span>), 200
                        </div>
                    </div>

                </div>

                <div
                    style="margin-top: 20px; background: #ebf5fb; padding: 15px; border-radius: 8px; border-left: 4px solid #3498db;">
                    <h4 style="margin: 0 0 10px 0; color: #2e86c1;">üõ†Ô∏è Where is this run? (Infrastructure as Code)
                    </h4>
                    <p style="font-size: 14px; margin: 0;">
                        While you can click buttons in the Fivetran UI, real engineers use <strong>Terraform
                            (CLI)</strong> to manage this as code.
                        You write the JSON/HCL config (like in the tooltips above) and run
                        <code>terraform apply</code> in your terminal.
                        This prompts Fivetran to create the connections automatically!
                    </p>
                </div>

                <div style="margin-top: 20px;">
                    <h4 style="color: #e67e22;">ü§î Terminology & Key Questions:</h4>
                    <ul style="font-size: 14px; line-height: 1.6;">
                        <li>
                            <span class="tooltip"><strong>Schema Drift:</strong>
                                <span class="tooltip-text">‚ö†Ô∏è Definition: When source data changes unexpectedly
                                    (e.g., new columns added). Good pipelines handle this automatically.</span>
                            </span>
                            "What happens if a new column is added?"
                            <br><em style="color: #7f8c8d;">(Answer: Fivetran automatically detects and adds the
                                column.)</em>
                        </li>
                        <li><strong>Frequency:</strong> "Do we really need
                            <span class="tooltip">Real-time
                                <span class="tooltip-text">‚ö° Definition: Processing data immediately as it arrives.
                                    Expensive and complex.</span>
                            </span>
                            ? Is
                            <span class="tooltip">Batch
                                <span class="tooltip-text">üì¶ Definition: Processing data in large chunks at
                                    intervals (e.g., hourly). Cheaper and standard for analytics.</span>
                            </span>
                            (1 hour) ok?"
                            <br><em style="color: #7f8c8d;">(Answer: Yes, batch is cheaper and sufficient for daily
                                dashboards.)</em>
                        </li>
                        <li><strong>Security:</strong> "How do I safely store passwords?"
                            <br><em style="color: #7f8c8d;">(Answer: Use a
                                <span class="tooltip">Secrets Manager
                                    <span class="tooltip-text">üîí Definition: A secure vault to store passwords.
                                        Your code asks the vault for the password at runtime.</span>
                                </span>
                                and reference it in Terraform!)</em>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="concept-card" style="border-left-color: #CD7F32;">
                <h3 style="color: #CD7F32;">Step 2: Bronze Layer (Raw)</h3>
                <p>Loading raw data from S3 into Snowflake tables.</p>
                <div class="code-block">
                    CREATE SCHEMA bronze;<br>
                    CREATE TABLE bronze.raw_orders AS SELECT * FROM @s3_stage/orders;<br>
                    <br>
                    <span style="color: #e74c3c;">-- Problem identified: 50 duplicate orders found!</span>
                </div>
            </div>

            <div class="concept-card" style="border-left-color: #95a5a6;">
                <h3 style="color: #95a5a6;">Step 3: Silver Layer (Cleaned)</h3>
                <p>Using <strong>dbt</strong> to clean data, remove duplicates, and standardize formats.</p>
                <div class="code-block">
                    <span style="color: #3498db;">-- dbt model: silver_orders.sql</span><br>
                    WITH distinct_orders AS (<br>
                    &nbsp;&nbsp;SELECT DISTINCT * FROM bronze.raw_orders<br>
                    )<br>
                    SELECT * FROM distinct_orders WHERE amount > 0;
                </div>
            </div>

            <div class="section-title" style="font-size: 32px; margin-top: 40px;">üìÖ Week 6: The Gold Layer (Star
                Schema)</div>

            <div class="concept-card" style="border-left-color: #FFD700;">
                <h3 style="color: #f1c40f;">üåü The Star Schema Design</h3>
                <p>Luke designs the Gold layer to answer specific business questions.</p>

                <div class="success-box">
                    <h4>Key Design Decisions:</h4>
                    <ul>
                        <li><strong>Grain:</strong> Order Line Item (to analyze individual products)</li>
                        <li><strong>Dim Customer:</strong> Type 2 SCD (to track segment changes over time)</li>
                        <li><strong>Measures:</strong> Quantity, Total Amount, Profit (future-proof)</li>
                    </ul>
                </div>

                <div class="code-block" style="margin-top: 20px;">
                    <span style="color: #95a5a6;">-- Creating External-Facing Dictionary (Dimensions)</span><br>
                    CREATE TABLE gold.dim_customer (customer_key INT, name VARCHAR, segment VARCHAR, ...);<br>
                    CREATE TABLE gold.dim_product (product_key INT, category VARCHAR, brand VARCHAR, ...);<br>
                    <br>
                    <span style="color: #27ae60;">-- Creating the Fact Table</span><br>
                    CREATE TABLE gold.fact_orders AS<br>
                    SELECT <br>
                    &nbsp;&nbsp;o.order_id,<br>
                    &nbsp;&nbsp;c.customer_key,<br>
                    &nbsp;&nbsp;p.product_key,<br>
                    &nbsp;&nbsp;d.date_key,<br>
                    &nbsp;&nbsp;1 as quantity,<br>
                    &nbsp;&nbsp;o.amount as total_amount,<br>
                    &nbsp;&nbsp;NULL as profit_amount <span style="color: #95a5a6;">-- Placeholder for
                        future</span><br>
                    FROM silver.orders o<br>

                    JOIN gold.dim_customer c ON o.customer_id = c.customer_id AND c.is_current = TRUE;
                </div>

                <div style="margin-top: 30px; background: white; padding: 20px; border-radius: 10px;">
                    <h4 style="text-align: center; margin-bottom: 10px;">üåü Star Schema Visual</h4>
                    <div class="mermaid">
                        erDiagram
                        FACT_ORDERS {
                        int order_id PK
                        int customer_key FK
                        int product_key FK
                        int date_key FK
                        int quantity
                        decimal total_amount
                        }
                        DIM_CUSTOMER {
                        int customer_key PK
                        string name
                        string segment
                        boolean is_current
                        }
                        DIM_PRODUCT {
                        int product_key PK
                        string category
                        string brand
                        }
                        DIM_DATE {
                        int date_key PK
                        date full_date
                        string day_of_week
                        }

                        FACT_ORDERS }|--|| DIM_CUSTOMER : "links to"
                        FACT_ORDERS }|--|| DIM_PRODUCT : "links to"
                        FACT_ORDERS }|--|| DIM_DATE : "links to"
                    </div>
                </div>
            </div>

            <div class="section-title" style="font-size: 32px; margin-top: 40px;">üìÖ Week 9: Success!</div>

            <div class="concept-card" style="border-left-color: #2ecc71;">
                <h3 style="color: #2ecc71;">üöÄ The Results</h3>

                <div class="info-box">
                    <h4>Scenario: Morning Standup</h4>
                    <p><strong>Sarah (Sales VP):</strong> "What was our revenue yesterday?"</p>
                    <p>She opens Tableau, clicks "Yesterday".</p>
                    <div class="code-block">
                        <span style="color: #95a5a6;">-- Query runs in Snowflake (Remote)</span><br>
                        SELECT SUM(revenue) FROM sales_mart WHERE date = CURRENT_DATE - 1;<br>
                        <span style="color: #27ae60;">-- Result: $45,000 (Returned in 2 seconds)</span>
                    </div>
                </div>

                <div class="success-box" style="margin-top: 20px;">
                    <h4>Impact:</h4>
                    <ul>
                        <li>‚úÖ <strong>Fast:</strong> Reports take 2 seconds (was 2 days)</li>
                        <li>‚úÖ <strong>Accurate:</strong> Single source of truth in Snowflake</li>
                        <li>‚úÖ <strong>Self-Service:</strong> Sales team creates their own reports</li>
                        <li>‚úÖ <strong>ROI:</strong> Saved $150k/year in manual work</li>
                    </ul>
                </div>
            </div>

            <div class="warning-box">
                <h3 style="text-align: center;">üéì What Luke Learned</h3>
                <div style="text-align: center; font-size: 16px; line-height: 2; margin: 20px 0;">
                    <div>Bronze/Silver/Gold separates concerns</div>
                    <div style="font-size: 24px;">‚Üì</div>
                    <div>Star Schemas make queries fast</div>
                    <div style="font-size: 24px;">‚Üì</div>
                    <div>Data Marts help specific teams</div>
                    <div style="font-size: 24px;">‚Üì</div>
                    <div><strong>Business Value > Technology</strong></div>
                </div>
            </div>

            <div class="section-title" style="font-size: 32px; margin-top: 60px;">üìÖ Weeks 10+: Scaling & Automation
                (Phase 2)</div>

            <div class="concept-card" style="border-left-color: #333;">
                <h3 style="color: #333;">üõ†Ô∏è 1. Version Control (Git & GitHub)</h3>
                <p><strong>The Limit:</strong> "Cowboy coding" (editing directly in production) causes bugs.</p>
                <p><strong>The Fix:</strong> Luke adopts a professional Git workflow.</p>
                <div class="code-block">
                    <span style="color: #95a5a6;">-- Local Development Workflow</span><br>
                    git checkout -b feature/new-churn-metric<br>
                    <span style="color: #27ae60;"># ... write dbt code ...</span><br>
                    git add .<br>
                    git commit -m "feat: Add churn rate calculation"<br>
                    git push origin feature/new-churn-metric<br>
                    <span style="color: #e74c3c;"># Open Pull Request (PR) on GitHub for review</span>
                </div>
            </div>

            <div class="concept-card" style="border-left-color: #FF6B6B;">
                <h3 style="color: #FF6B6B;">üîÅ 2. dbt Advanced (Macros & Materializations)</h3>
                <p><strong>The Limit:</strong> Copy-pasting SQL logic 50 times.</p>
                <p><strong>The Fix:</strong> Using **Jinja Macros** (functions for SQL) and **Incremental Models**.
                </p>
                <div class="code-block">
                    <span style="color: #3498db;">-- macro: cents_to_dollars.sql</span><br>
                    {% macro cents_to_dollars(column_name) %}<br>
                    &nbsp;&nbsp;({{ column_name }} / 100)::numeric(16, 2)<br>
                    {% endmacro %}<br>
                    <br>
                    <span style="color: #27ae60;">-- Using the macro in a model</span><br>
                    SELECT<br>
                    &nbsp;&nbsp;order_id,<br>
                    &nbsp;&nbsp;{{ cents_to_dollars('amount_cents') }} as amount_dollars<br>
                    FROM {{ ref('stg_orders') }}
                </div>
            </div>

            <div class="concept-card" style="border-left-color: #00C7B7;">
                <h3 style="color: #00C7B7;">‚ö° 3. Orchestration (Airflow)</h3>
                <p><strong>The Limit:</strong> Manually running Fivetran, then dbt, then Tableau refresh.</p>
                <p><strong>The Fix:</strong> An **Airflow DAG** (Directed Acyclic Graph) automates the dependency
                    chain.</p>
                <div class="code-block">
                    <span style="color: #95a5a6;"># airflow_dag.py</span><br>
                    <span style="color: #e67e22;">start</span> = DummyOperator(task_id='start')<br>
                    <br>
                    <span style="color: #3498db;">ingest</span> = FivetranOperator(task_id='fivetran_sync')<br>
                    <span style="color: #FF6B6B;">transform</span> = DbtRunOperator(task_id='dbt_run')<br>
                    <span style="color: #9b59b6;">refresh_bi</span> =
                    TableauRefreshOperator(task_id='refresh_tableau')<br>
                    <br>
                    <span style="color: #27ae60;"># Define dependencies</span><br>
                    start >> ingest >> transform >> refresh_bi
                </div>
            </div>

            <div class="concept-card" style="border-left-color: #FF9F1C;">
                <h3 style="color: #FF9F1C;">üêò 4. Big Data (Spark/Databricks)</h3>
                <p><strong>The Limit:</strong> 10TB of messy raw logs crashes the Data Warehouse.</p>
                <p><strong>The Fix:</strong> Use **PySpark** on a cluster (Databricks) to process data *before*
                    loading.</p>
                <div class="code-block">
                    <span style="color: #95a5a6;"># process_logs.py (PySpark)</span><br>
                    df = spark.read.json("s3://raw-logs/*.json")<br>
                    <br>
                    <span style="color: #e67e22;"># Filter high-volume noise distributedly</span><br>
                    clean_df = df.filter(df.status != 'error')\<br>
                    &nbsp;&nbsp;.groupBy("user_id")\<br>
                    &nbsp;&nbsp;.agg(count("*").alias("click_count"))<br>
                    <br>
                    <span style="color: #3498db;"># Save small aggregated result to Warehouse</span><br>
                    clean_df.write.format("snowflake").save("bronze.user_clicks")
                </div>
            </div>

            <div class="success-box"
                style="margin-top: 40px; background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);">
                <h3 style="text-align: center; color: #006064;">üéì The Complete Evolution</h3>
                <div style="text-align: center; font-size: 16px; line-height: 2; margin: 20px 0;">
                    <div>Phase 1: <strong>SQL & Warehousing</strong> (Foundation)</div>
                    <div style="font-size: 24px;">‚Üì</div>
                    <div>Phase 2: <strong>Engineering Rigor</strong> (Git, dbt, Airflow)</div>
                    <div style="font-size: 24px;">‚Üì</div>
                    <div>Phase 3: <strong>Big Data Scale</strong> (Spark, Streaming)</div>
                </div>
            </div>

        </div>
    </div>

    <!-- QUIZ TAB (DYNAMIC) -->
    <div id="quiz" class="tab-content">
        <div class="section">
            <div class="section-title">
                <span style="font-size: 48px;">üß†</span>
                <span>Mastery Check</span>
            </div>

            <!-- SETUP SCREEN -->
            <div id="quiz-setup" class="info-box" style="text-align: center; padding: 40px;">
                <h3>Ready to test your skills?</h3>
                <p>Select your challenge level below.</p>

                <div style="margin: 20px 0; display: inline-grid; gap: 15px; text-align: left;">
                    <label style="font-weight: bold;">Difficulty:</label>
                    <select id="diff-select" style="padding: 10px; border-radius: 5px; width: 200px;">
                        <option value="all">Mixed (All Levels)</option>
                        <option value="Beginner">Beginner (Concepts)</option>
                        <option value="Intermediate">Intermediate (Schema/SQL)</option>
                        <option value="Advanced">Advanced (Streaming/Ops)</option>
                    </select>

                    <label style="font-weight: bold;">Questions:</label>
                    <select id="count-select" style="padding: 10px; border-radius: 5px; width: 200px;">
                        <option value="5">5 Questions</option>
                        <option value="10">10 Questions</option>
                        <option value="20">All Available</option>
                    </select>
                </div>

                <br>
                <button onclick="startQuiz()"
                    style="padding: 15px 40px; background: #27ae60; color: white; font-size: 18px; border: none; border-radius: 30px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">Start
                    Quiz üöÄ</button>
            </div>

            <!-- GAME SCREEN -->
            <div id="quiz-game" style="display: none;">
                <div
                    style="display: flex; justify-content: space-between; margin-bottom: 20px; font-weight: bold; color: #7f8c8d;">
                    <span id="q-progress">Question 1/5</span>
                    <span id="q-score" style="color: #27ae60;">Score: 0</span>
                </div>

                <div id="q-card" class="concept-card" style="min-height: 200px;">
                    <!-- Question injected here -->
                </div>
            </div>

            <!-- RESULT SCREEN -->
            <div id="quiz-result" class="success-box" style="display: none; text-align: center; padding: 40px;">
                <h2 id="final-score-title">Great Job!</h2>
                <div id="final-score" style="font-size: 64px; font-weight: bold; color: #27ae60; margin: 20px 0;">80%
                </div>
                <p id="final-msg">You know your stuff!</p>
                <button onclick="location.reload()"
                    style="padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer; margin-top: 20px;">Play
                    Again üîÑ</button>
            </div>

        </div>

        <script>
            // GLOBAL QUIZ STATE
            let currentQuestions = [];
            let currentIdx = 0;
            let score = 0;

            const QUESTION_BANK = [
                // BEGINNER
                { id: 1, diff: 'Beginner', q: "What is the main difference between ETL and ELT?", options: { a: "ETL is faster", b: "ETL transforms BEFORE loading, ELT transforms AFTER", c: "ETL is for cloud only", d: "No difference" }, correct: 'b', explain: "ELT (Extract, Load, Transform) loads raw data first, enabling modern cloud scaling." },
                { id: 2, diff: 'Beginner', q: "Which database type is best for unstructured data (images/logs)?", options: { a: "Relational (MySQL)", b: "Data Lake (S3)", c: "Data Mart", d: "Star Schema" }, correct: 'b', explain: "Data Lakes are designed to store raw, undefined data types." },
                { id: 3, diff: 'Beginner', q: "What does OLTP stand for?", options: { a: "Online Transaction Processing", b: "Online Analytical Processing", c: "Offline Transaction Protocol", d: "Overloaded Table Protocol" }, correct: 'a', explain: "OLTP handles day-to-day app transactions (Inserts/Updates)." },
                { id: 4, diff: 'Beginner', q: "What is a Data Mart?", options: { a: "A data store", b: "A subset of a warehouse for a specific team", c: "A backup", d: "A NoSQL DB" }, correct: 'b', explain: "Marts are subject-oriented slices of the warehouse." },

                // INTERMEDIATE
                { id: 5, diff: 'Intermediate', q: "In a Star Schema, what does the Fact Table contain?", options: { a: "Customer Names", b: "Product Categories", c: "Measurements/Metrics (Numbers)", d: "Dates" }, correct: 'c', explain: "Fact tables hold the Numbers (Facts), Dimensions hold the Context." },
                { id: 6, diff: 'Intermediate', q: "Which is a 'Non-Additive' metric?", options: { a: "Revenue", b: "Cost", c: "Average Order Value", d: "Quantity" }, correct: 'c', explain: "You cannot sum Averages. You must recalculate them." },
                { id: 7, diff: 'Intermediate', q: "What is a 'Slowly Changing Dimension' Type 2?", options: { a: "Overwriting old data", b: "Creating a new row for every change (History)", c: "Ignoring changes", d: "Deleting old data" }, correct: 'b', explain: "SCD Type 2 preserves history by adding new rows." },
                { id: 8, diff: 'Intermediate', q: "What is 'Schema Drift'?", options: { a: "Database moving servers", b: "Source data structure changing unexpectedly", c: "Slow queries", d: "Lost passwords" }, correct: 'b', explain: "Drift happens when upstream sources change columns/types without warning." },

                // ADVANCED (NEW TOPICS)
                { id: 9, diff: 'Advanced', q: "What is the primary role of Kafka?", options: { a: "Long-term storage", b: "Real-time Event Streaming", c: "Batch Processing", d: "Generating Reports" }, correct: 'b', explain: "Kafka acts as the 'Central Nervous System' for real-time data flow." },
                { id: 10, diff: 'Advanced', q: "In Airflow, what is a DAG?", options: { a: "Database Admin Group", b: "Directed Acyclic Graph (Workflow)", c: "Data Access Gateway", d: "Daily Average Growth" }, correct: 'b', explain: "DAGs define the dependency chain of tasks (A -> B -> C)." },
                { id: 11, diff: 'Advanced', q: "Why use 'git checkout -b'?", options: { a: "To delete code", b: "To create a new branch for a feature", c: "To push to production", d: "To undo changes" }, correct: 'b', explain: "Branching isolates your changes from the main code until they are ready." },
                { id: 12, diff: 'Advanced', q: "What distinguishes 'Pull' (Fivetran) from 'Push' (Webhook)?", options: { a: "Pull is faster", b: "Pull is initiated by the Pipeline; Push is initiated by the Source", c: "Push is invalid", d: "No difference" }, correct: 'b', explain: "Pull = 'Checking logs'; Push = 'Source shouting new events'." },
                { id: 13, diff: 'Advanced', q: "Which tool is an Open Source alternative to Fivetran?", options: { a: "Snowflake", b: "Airbyte", c: "Tableau", d: "dbt" }, correct: 'b', explain: "Airbyte is the leading open-source ELT tool." },
                { id: 14, diff: 'Advanced', q: "What does 'Idempotent' mean in data engineering?", options: { a: "Fast queries", b: "Running the same job twice produces the same result", c: "Data loss", d: "Secure encryption" }, correct: 'b', explain: "Crucial for reliability: retrying a failed job shouldn't duplicate data." }
            ];

            function startQuiz() {
                const diff = document.getElementById('diff-select').value;
                const limit = parseInt(document.getElementById('count-select').value);

                // 1. Filter
                let pool = QUESTION_BANK;
                if (diff !== 'all') {
                    pool = QUESTION_BANK.filter(q => q.diff === diff);
                }

                // 2. Shuffle
                pool.sort(() => Math.random() - 0.5);

                // 3. Limit
                currentQuestions = pool.slice(0, limit);

                // 4. Initialize
                if (currentQuestions.length === 0) {
                    alert("No questions found for this filter!");
                    return;
                }

                currentIdx = 0;
                score = 0;
                document.getElementById('quiz-setup').style.display = 'none';
                document.getElementById('quiz-game').style.display = 'block';
                renderQuestion();
            }

            function renderQuestion() {
                const q = currentQuestions[currentIdx];
                document.getElementById('q-progress').innerText = `Question ${currentIdx + 1}/${currentQuestions.length}`;
                document.getElementById('q-score').innerText = `Score: ${score}`;

                const html = `
                <div style="display:flex; justify-content:space-between;">
                    <span style="background: #eee; padding: 2px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">${q.diff}</span>
                </div>
                <h4 style="margin: 15px 0 25px 0; font-size: 18px;">${q.q}</h4>
                <div style="display: grid; gap: 10px;">
                    ${Object.keys(q.options).map(key => `
                        <button onclick="checkAnswer('${key}')" class="option-btn" id="opt-${key}"
                            style="padding: 15px; border: 1px solid #bdc3c7; background: white; text-align: left; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                            ${key.toUpperCase()}) ${q.options[key]}
                        </button>
                    `).join('')}
                </div>
                <div id="feedback" style="margin-top: 20px; font-weight: bold; display: none;"></div>
                <button id="next-btn" onclick="nextQuestion()" style="display: none; margin-top: 20px; padding: 10px 20px; background: #34495e; color: white; border: none; border-radius: 5px; cursor: pointer;">Next ‚û°</button>
            `;
                document.getElementById('q-card').innerHTML = html;
            }

            function checkAnswer(selectedKey) {
                const q = currentQuestions[currentIdx];
                const feedback = document.getElementById('feedback');
                const nextBtn = document.getElementById('next-btn');

                // Disable all buttons
                document.querySelectorAll('.option-btn').forEach(btn => {
                    btn.disabled = true;
                    if (btn.id === `opt-${q.correct}`) {
                        btn.style.background = '#d4edda';
                        btn.style.borderColor = '#27ae60';
                    } else if (btn.id === `opt-${selectedKey}` && selectedKey !== q.correct) {
                        btn.style.background = '#f8d7da';
                        btn.style.borderColor = '#c0392b';
                    }
                });

                if (selectedKey === q.correct) {
                    score++;
                    feedback.innerHTML = `<span style="color: #27ae60;">‚úÖ Correct!</span> ${q.explain}`;
                } else {
                    feedback.innerHTML = `<span style="color: #c0392b;">‚ùå Incorrect.</span> ${q.explain}`;
                }

                feedback.style.display = 'block';
                nextBtn.style.display = 'inline-block';
                document.getElementById('q-score').innerText = `Score: ${score}`;
            }

            function nextQuestion() {
                currentIdx++;
                if (currentIdx >= currentQuestions.length) {
                    showResults();
                } else {
                    renderQuestion();
                }
            }

            function showResults() {
                document.getElementById('quiz-game').style.display = 'none';
                document.getElementById('quiz-result').style.display = 'block';

                const pct = Math.round((score / currentQuestions.length) * 100);
                document.getElementById('final-score').innerText = `${pct}%`;

                let msg = "Keep practicing!";
                if (pct === 100) msg = "üèÜ Absolute Legend!";
                else if (pct >= 80) msg = "üî• Data Engineer status unlocked!";
                else if (pct >= 60) msg = "üëç Good start!";

                document.getElementById('final-msg').innerText = msg;
            }
        </script>
    </div>

    <script>
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }


    </script>


    <!-- SPEAKING DATA TAB (INTERVIEW PREP) -->
    <div id="speaking" class="tab-content">
        <div class="section">
            <div class="section-title">
                <span style="font-size: 48px;">üó£Ô∏è</span>
                <span>Speaking "Data"</span>
            </div>

            <div class="info-box">
                <h3 style="text-align: center;">Don't Just Code It, Sell It.</h3>
                <p style="text-align: center; font-size: 16px;">
                    The difference between a Junior and a Senior Engineer is often <strong>communication</strong>.
                    Use these "Flashcards" to practice explaining complex concepts simply.
                </p>
                <p style="text-align: center; margin-top: 10px; font-style: italic;">(Click a card to reveal the "Pro
                    Answer")</p>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">

                <!-- CARD 1: ELEVATOR PITCH -->
                <div class="concept-card" onclick="toggleCard(this)" style="cursor: pointer; min-height: 250px;">
                    <h4 style="color: #2c3e50;">üé§ The Elevator Pitch</h4>
                    <p style="font-size: 18px; text-align: center; margin-top: 20px; color: #7f8c8d;">
                        "So, what do you actually do?"
                    </p>
                    <p class="click-hint" style="text-align: center; margin-top: 20px;">üëá Click to Reveal</p>

                    <div class="reveal-content"
                        style="display: none; margin-top: 20px; border-top: 1px dashed #ccc; padding-top: 20px;">
                        <strong style="color: #27ae60;">The Engineer's Answer:</strong>
                        <p style="font-size: 16px; margin-top: 10px; line-height: 1.6;">
                            "I don't just write SQL. I build <strong>automated data pipelines</strong> that turn raw,
                            messy logs into <strong>trustworthy dashboards</strong> so the business can make decisions
                            in minutes, not days."
                        </p>
                    </div>
                </div>

                <!-- CARD 2: ELT vs ETL -->
                <div class="concept-card" onclick="toggleCard(this)" style="cursor: pointer; min-height: 250px;">
                    <h4 style="color: #3498db;">ü§î "Why did you choose ELT over ETL?"</h4>
                    <p style="font-size: 14px; color: #95a5a6; margin-bottom: 10px;">(Common Interview Question)</p>
                    <p class="click-hint" style="text-align: center; margin-top: 20px;">üëá Click to Reveal</p>

                    <div class="reveal-content"
                        style="display: none; margin-top: 15px; background: #e8f4f8; padding: 15px; border-radius: 8px;">
                        <strong style="color: #2980b9;">The Narrative:</strong>
                        <p style="font-size: 15px; margin-top: 5px;">
                            "We moved to <strong>ELT</strong> to decouple Engineering from Analytics. By loading raw
                            data first, our analysts can move as fast as they can write SQL, without waiting on me to
                            change a Python script every time they need a new column."
                        </p>
                    </div>
                </div>

                <!-- CARD 3: STAR SCHEMA -->
                <div class="concept-card" onclick="toggleCard(this)" style="cursor: pointer; min-height: 250px;">
                    <h4 style="color: #f39c12;">‚≠ê "Why use a Star Schema?"</h4>
                    <p style="font-size: 14px; color: #95a5a6; margin-bottom: 10px;">(Design Defense)</p>
                    <p class="click-hint" style="text-align: center; margin-top: 20px;">üëá Click to Reveal</p>

                    <div class="reveal-content"
                        style="display: none; margin-top: 15px; background: #fef9e7; padding: 15px; border-radius: 8px;">
                        <strong style="color: #d35400;">The Logic:</strong>
                        <p style="font-size: 15px; margin-top: 5px;">
                            "It's about <strong>Cognitive Load</strong>. A Star Schema matches how humans naturally
                            think: 'Sales' (Fact) by 'Customer' (Dimension). It makes the data self-documenting for end
                            users."
                        </p>
                    </div>
                </div>

                <!-- CARD 4: STAR METHOD (BEHAVIORAL) -->
                <div class="concept-card" onclick="toggleCard(this)" style="cursor: pointer; min-height: 250px;">
                    <h4 style="color: #e74c3c;">ü¶∏ The S.T.A.R. Method (Behavioral)</h4>
                    <p style="font-size: 14px; color: #95a5a6; margin-bottom: 10px;">"Tell me about a time you fixed a
                        bug..."</p>
                    <p class="click-hint" style="text-align: center; margin-top: 20px;">üëá Click to Reveal</p>

                    <div class="reveal-content"
                        style="display: none; margin-top: 15px; background: #f9ebea; padding: 15px; border-radius: 8px;">
                        <ul style="list-style: none;">
                            <li style="margin-bottom: 8px;"><strong>S (Situation):</strong> "Data was arriving late
                                every Monday."</li>
                            <li style="margin-bottom: 8px;"><strong>T (Task):</strong> "I needed to identify the
                                bottleneck."</li>
                            <li style="margin-bottom: 8px;"><strong>A (Action):</strong> "I implemented Airflow SLAs and
                                optimized the SQL query."</li>
                            <li><strong>R (Result):</strong> "Reduced runtime by 40% and zero missed deadlines since."
                            </li>
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        function toggleCard(card) {
            const content = card.querySelector('.reveal-content');
            const hint = card.querySelector('.click-hint');
            if (content.style.display === 'none') {
                content.style.display = 'block';
                hint.style.display = 'none';
            } else {
                content.style.display = 'none';
                hint.style.display = 'block';
            }
        }
    </script>

    <!-- Notes Feature -->
    <button class="notes-button" onclick="toggleNotes()" title="My Notes">üìù</button>

    <div id="notesPanel" class="notes-panel">
        <div class="notes-header">
            <h2 style="margin: 0;">üìù My Notes</h2>
            <button class="notes-close" onclick="toggleNotes()">√ó</button>
        </div>
        <div class="notes-content">
            <div class="note-input-area">
                <textarea id="noteInput" placeholder="Add a note about what you're learning..."></textarea>
                <button onclick="addNote()">üíæ Save Note</button>
            </div>
            <div id="notesList" style="margin-top: 30px;">
                <!-- Notes will be displayed here -->
            </div>
        </div>
    </div>

    <script>
        // Notes functionality
        let currentTab = 'crawl-intro';

        // Track current tab
        const originalShowTab = showTab;
        showTab = function (tabName) {
            currentTab = tabName;
            originalShowTab(tabName);
        };

        function toggleNotes() {
            const panel = document.getElementById('notesPanel');
            panel.classList.toggle('open');
        }

        function addNote() {
            const input = document.getElementById('noteInput');
            const noteText = input.value.trim();

            if (!noteText) {
                alert('Please enter a note!');
                return;
            }

            // Get existing notes from localStorage
            let notes = JSON.parse(localStorage.getItem('dataEngineeringNotes') || '[]');

            // Add new note
            const note = {
                id: Date.now(),
                tab: currentTab,
                text: noteText,
                timestamp: new Date().toLocaleString()
            };

            notes.push(note);

            // Save to localStorage
            localStorage.setItem('dataEngineeringNotes', JSON.stringify(notes));

            // Clear input
            input.value = '';

            // Refresh display
            displayNotes();
        }

        function deleteNote(noteId) {
            if (!confirm('Delete this note?')) return;

            let notes = JSON.parse(localStorage.getItem('dataEngineeringNotes') || '[]');
            notes = notes.filter(note => note.id !== noteId);
            localStorage.setItem('dataEngineeringNotes', JSON.stringify(notes));
            displayNotes();
        }

        function displayNotes() {
            const notesList = document.getElementById('notesList');
            const notes = JSON.parse(localStorage.getItem('dataEngineeringNotes') || '[]');

            if (notes.length === 0) {
                notesList.innerHTML = '<p style="color: #95a5a6; text-align: center;">No notes yet. Start adding notes as you learn!</p>';
                return;
            }

            // Sort notes by timestamp (newest first)
            notes.sort((a, b) => b.id - a.id);

            notesList.innerHTML = notes.map(note => `
                <div class="note-item">
                    <div class="note-tab">üìç Tab: ${getTabName(note.tab)} | üïí ${note.timestamp}</div>
                    <div class="note-text">${note.text.replace(/\n/g, '<br>')}</div>
                    <button class="note-delete" onclick="deleteNote(${note.id})">Delete</button>
                </div>
            `).join('');
        }

        function getTabName(tabId) {
            const tabNames = {
                'crawl-intro': 'üêõ START: Crawl',
                'databases': 'üêõ Databases',
                'etl-elt': 'üêõ ETL vs ELT',
                'lake-mart': 'üêõ Lake & Mart',
                'warehouse': 'üö∂ Warehouse Layers',
                'architecture': 'üö∂ Architecture',
                'stages': 'üö∂ DE Pipeline',
                'metrics': 'üèÉ Metrics & KPIs',
                'terminology': 'üèÉ Terminology',
                'real-world': 'üõí Follow Luke',
                'quiz': '‚úÖ Quiz'
            };
            return tabNames[tabId] || tabId;
        }

        // Load notes when page loads
        window.addEventListener('load', displayNotes);
    </script>
</body>

</html>