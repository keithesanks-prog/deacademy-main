<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Antics: Snowflake Streams</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Nunito:wght@400;700&display=swap');

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #fdf2f8;
            /* Pink/Rose background */
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 900px;
            margin: 40px auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            border-bottom: 8px solid #db2777;
        }

        .header {
            background: #ec4899;
            color: white;
            padding: 40px;
            text-align: center;
            border-bottom: 8px solid #db2777;
        }

        .header h1 {
            font-family: 'Fredoka', sans-serif;
            font-size: 3em;
            margin: 0;
            text-shadow: 3px 3px 0px rgba(0, 0, 0, 0.2);
        }

        .content-block {
            padding: 40px;
        }

        .dialogue-box {
            background: #fdf2f8;
            border-left: 6px solid #db2777;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 0 10px 10px 0;
            font-size: 1.1em;
        }

        .rob {
            font-weight: bold;
            color: #be185d;
            font-family: 'Fredoka', sans-serif;
            font-size: 1.2em;
        }

        .analogy-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 40px 0;
        }

        .analogy-card {
            background: #fff;
            border: 2px solid #ddd;
            padding: 20px;
            border-radius: 12px;
            transition: transform 0.2s;
        }

        .source-card {
            border-top: 5px solid #f59e0b;
        }

        .stream-card {
            border-top: 5px solid #ec4899;
        }

        .card-title {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.5em;
            margin-bottom: 10px;
            color: #831843;
        }

        .icon-large {
            font-size: 4em;
            display: block;
            margin-bottom: 10px;
            text-align: center;
        }

        .timestamp {
            font-family: monospace;
            color: #9d174d;
            font-weight: bold;
            margin-right: 10px;
        }

        .code-snippet {
            background: #1e293b;
            color: #fbcfe8;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            margin-top: 10px;
            font-size: 0.9em;
            overflow-x: auto;
        }

        .vs-badge {
            display: inline-block;
            background: #db2777;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        /* Progress Sidebar */
        .progress-sidebar {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            border-radius: 12px;
            padding: 20px 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            width: 220px;
            z-index: 1000;
        }

        .progress-title {
            font-family: 'Fredoka', sans-serif;
            font-size: 0.9em;
            color: #831843;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid #fce7f3;
            padding-bottom: 8px;
        }

        .progress-step {
            display: flex;
            align-items: center;
            margin: 12px 0;
            padding: 8px;
            border-radius: 6px;
            transition: all 0.2s;
            text-decoration: none;
            color: #666;
            font-size: 0.85em;
        }

        .progress-step:hover {
            background: #fdf2f8;
            transform: translateX(3px);
        }

        .progress-step.active {
            background: #ec4899;
            color: white;
            font-weight: bold;
        }

        .progress-step.completed {
            background: #d1fae5;
            color: #065f46;
        }

        .step-icon {
            margin-right: 8px;
            font-size: 1.2em;
        }

        .step-text {
            flex: 1;
            line-height: 1.3;
        }

        .metadata-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
            margin-top: 10px;
        }

        .metadata-table th {
            background: #fce7f3;
            color: #831843;
            text-align: left;
            padding: 8px;
            border-bottom: 2px solid #db2777;
        }

        .metadata-table td {
            border-bottom: 1px solid #ddd;
            padding: 8px;
        }

        @media (max-width: 1400px) {
            .progress-sidebar {
                display: none;
            }
        }
    </style>
</head>

<body>

    <!-- Progress Sidebar -->
    <div class="progress-sidebar">
        <div class="progress-title">üìö Data Loading Path</div>

        <a href="snowflake_stages_antics.html" class="progress-step completed">
            <span class="step-icon">‚úÖ</span>
            <span class="step-text">Stages (Loading Dock)</span>
        </a>

        <a href="snowflake_file_formats_antics.html" class="progress-step completed">
            <span class="step-icon">‚úÖ</span>
            <span class="step-text">File Formats (Rules)</span>
        </a>

        <a href="snowflake_loading_antics.html" class="progress-step completed">
            <span class="step-icon">‚úÖ</span>
            <span class="step-text">Loading Methods</span>
        </a>

        <a href="snowflake_streams_antics.html" class="progress-step active">
            <span class="step-icon">üé•</span>
            <span class="step-text">Streams (CDC)</span>
        </a>

        <a href="snowflake_searchable_data.html" class="progress-step">
            <span class="step-icon">üìç</span>
            <span class="step-text">Hands-On Lab</span>
        </a>
    </div>

    <div class="container">
        <div class="header">
            <h1>Cloud Antics</h1>
            <p>Snowflake Streams: Change Data Capture</p>
        </div>

        <div class="content-block">

            <div class="dialogue-box">
                <span class="rob">Rob:</span> Imagine your table is a busy room. People enter (INSERT), leave (DELETE),
                or change clothes (UPDATE).
                <br><br>
                <span class="timestamp">0:10</span> How do we know <em>exactly</em> what happened without checking the
                whole room every time?
                <br>
                <span class="timestamp">0:15</span> You install a <strong>Security Camera</strong> (The Stream). It
                records a log of every movement.
            </div>

            <div class="analogy-grid">

                <!-- The Source -->
                <div class="analogy-card source-card">
                    <div class="icon-large">üè†</div>
                    <div class="card-title">The Source Table</div>
                    <div class="vs-badge">THE ROOM</div>
                    <p><strong>Where the changes happen.</strong></p>
                    <p>This is your standard storage. It creates the "truth" at any given moment.</p>
                </div>

                <!-- The Stream -->
                <div class="analogy-card stream-card">
                    <div class="icon-large">üìπ</div>
                    <div class="card-title">The Stream</div>
                    <div class="vs-badge">THE CAMERA (CDC)</div>
                    <p><strong>The "Audit Log"</strong></p>
                    <p>A Stream object tracks all DML operations (Insert, Update, Delete) against the source table.</p>
                </div>
            </div>

            <div
                style="background: #fff1f2; border: 2px dashed #f43f5e; padding: 20px; border-radius: 12px; margin-top: 30px;">
                <h3 style="color: #be123c; margin-top: 0;">üîé Under the Hood: The 3 Metadata Columns</h3>
                <p>When you create a Stream, Snowflake secretly adds three invisible columns to the source table
                    metadata to track changes.</p>

                <table class="metadata-table">
                    <thead>
                        <tr>
                            <th>Column Name</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>METADATA$ACTION</code></td>
                            <td>What happened? Values: <strong>INSERT</strong> or <strong>DELETE</strong>.
                                <br><em>(Note: UPDATE is recorded as a DELETE of the old row + INSERT of the new
                                    row!)</em>
                            </td>
                        </tr>
                        <tr>
                            <td><code>METADATA$ISUPDATE</code></td>
                            <td><strong>TRUE</strong> if the action was part of an UPDATE
                                operation.<br><strong>FALSE</strong> if it was a pure INSERT or DELETE.</td>
                        </tr>
                        <tr>
                            <td><code>METADATA$ROW_ID</code></td>
                            <td>A unique hash identifier for the specific row being changed.</td>
                        </tr>
                    </tbody>
                </table>

                <h4 style="color: #be185d; margin-top: 25px;">üß™ Live Experiment: The INSERT</h4>
                <div class="code-snippet">
                    -- 1. We insert a new record into the source table<br>
                    <span style="color: #fca5a5;">INSERT INTO</span> my_table <span
                        style="color: #fca5a5;">VALUES</span> (3, 'Johnny', '2023-12-11');<br><br>

                    -- 2. We query the stream to see what it saw<br>
                    <span style="color: #60a5fa;">SELECT</span> * <span style="color: #60a5fa;">FROM</span>
                    my_standard_stream;
                </div>

                <div
                    style="background: white; border: 1px solid #ddd; padding: 10px; margin-top: 10px; border-radius: 6px; overflow-x: auto;">
                    <strong style="color: #666; font-size: 0.8em; text-transform: uppercase;">Result Set:</strong>
                    <table class="metadata-table" style="margin-top: 5px;">
                        <tr style="background: #f3f4f6; color: #374151;">
                            <td>ID</td>
                            <td>NAME</td>
                            <td>METADATA$ACTION</td>
                            <td>METADATA$ISUPDATE</td>
                            <td>METADATA$ROW_ID</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Johnny</td>
                            <td><span style="color: #059669; font-weight: bold;">INSERT</span></td>
                            <td><span style="color: #dc2626; font-weight: bold;">FALSE</span></td>
                            <td style="font-family: monospace; font-size: 0.8em;">e00d7758...</td>
                        </tr>
                    </table>
                </div>

                <p
                    style="font-size: 0.9em; background: #fffbeb; padding: 10px; border-radius: 4px; border-left: 4px solid #f59e0b; margin-top: 15px;">
                    <strong>üí° Analysis:</strong> notice that <code>METADATA$ISUPDATE</code> is <strong>FALSE</strong>.
                    <br>
                    This confirms that the data was purely <em>inserted</em>, not updated from an existing record.
                </p>
            </div>

            <h3 style="color: #be123c; margin-top: 40px; margin-bottom: 20px; text-align: center;">üç¶ Three Flavors of
                Streams</h3>

            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">

                <!-- Standard -->
                <div class="analogy-card" style="border-top: 5px solid #ec4899;">
                    <div style="font-size: 3em; text-align: center; margin-bottom: 10px;">üîÑ</div>
                    <div class="card-title" style="font-size: 1.2em; text-align: center;">Standard</div>
                    <p style="font-size: 0.9em;">
                        The full package. Tracks <strong>all</strong> modifications:
                    </p>
                    <ul style="font-size: 0.9em; padding-left: 20px;">
                        <li>‚úÖ Inserts</li>
                        <li>‚úÖ Updates</li>
                        <li>‚úÖ Deletes</li>
                    </ul>
                    <p style="font-size: 0.85em; color: #666; background: #fdf2f8; padding: 5px; border-radius: 4px;">
                        Best for full Change Data Capture (CDC).
                    </p>
                </div>

                <!-- Append Only -->
                <div class="analogy-card" style="border-top: 5px solid #10b981;">
                    <div style="font-size: 3em; text-align: center; margin-bottom: 10px;">‚ûï</div>
                    <div class="card-title" style="font-size: 1.2em; text-align: center;">Append-Only</div>
                    <p style="font-size: 0.9em;">
                        Strictly tracks <strong>new rows</strong> added to the table.
                    </p>
                    <ul style="font-size: 0.9em; padding-left: 20px;">
                        <li>‚úÖ Inserts (Only)</li>
                        <li>‚ùå Updates</li>
                        <li>‚ùå Deletes</li>
                    </ul>
                    <p style="font-size: 0.85em; color: #666; background: #ecfdf5; padding: 5px; border-radius: 4px;">
                        Great when you just need to see new data arrives.
                    </p>
                </div>

                <!-- Insert Only -->
                <div class="analogy-card" style="border-top: 5px solid #3b82f6;">
                    <div style="font-size: 3em; text-align: center; margin-bottom: 10px;">‚òÅÔ∏è</div>
                    <div class="card-title" style="font-size: 1.2em; text-align: center;">Insert-Only</div>
                    <div class="vs-badge"
                        style="background: #3b82f6; display: block; text-align: center; margin: 0 auto 10px auto; width: fit-content;">
                        EXTERNAL TABLES</div>
                    <p style="font-size: 0.9em;">
                        Supported on <strong>External Tables</strong> only.
                    </p>
                    <ul style="font-size: 0.9em; padding-left: 20px;">
                        <li>‚úÖ Inserts (Only)</li>
                        <li>‚ùå Deletes</li>
                    </ul>
                    <p style="font-size: 0.85em; color: #666; background: #eff6ff; padding: 5px; border-radius: 4px;">
                        Specific to data living outside Snowflake (S3/Azure).
                    </p>
                </div>
            </div>

            <!-- Lab Phase 1 -->
            <div
                style="background: #f8fafc; border: 2px solid #cbd5e1; border-radius: 12px; padding: 25px; margin-bottom: 30px;">
                <h3 style="color: #334155; margin-top: 0; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">üõ†Ô∏è
                    Lab Phase 1: Setting the Stage</h3>
                <p>Before we create a stream, we need a source table (The Room) with some initial people (Data) inside.
                </p>

                <div class="substep" style="margin-bottom: 20px;">
                    <strong style="color: #0f172a;">Step 1: Create Source Table</strong>
                    <div class="code-snippet">
                        <span style="color: #94a3b8;">-- Setup Context</span><br>
                        <span style="color: #60a5fa;">USE ROLE</span> ACCOUNTADMIN;<br>
                        <span style="color: #60a5fa;">USE WAREHOUSE</span> COMPUTE_WH;<br>
                        <span style="color: #60a5fa;">USE SCHEMA</span> MYDB.MYSCHEMA;<br><br>

                        <span style="color: #94a3b8;">-- Create a source table1</span><br>
                        <span style="color: #c084fc;">CREATE OR REPLACE TABLE</span> SOURCE_TABLE1<br>
                        (<br>
                        &nbsp;&nbsp;ID INT,<br>
                        &nbsp;&nbsp;NAME STRING,<br>
                        &nbsp;&nbsp;CREATE_DATE DATE<br>
                        );
                    </div>
                </div>

                <div class="substep" style="margin-bottom: 20px;">
                    <strong style="color: #0f172a;">Step 2: Populate Initial Data</strong>
                    <div class="code-snippet">
                        <span style="color: #94a3b8;">-- Insert some records in the source table1</span><br>
                        <span style="color: #fca5a5;">INSERT INTO</span> SOURCE_TABLE1<br>
                        <span style="color: #fca5a5;">VALUES</span><br>
                        (1, <span style="color: #86efac;">'Tom'</span>, <span
                            style="color: #86efac;">'2025-10-31'</span>),<br>
                        (2, <span style="color: #86efac;">'Sam'</span>, <span
                            style="color: #86efac;">'2025-10-31'</span>);
                    </div>
                </div>

                <div class="substep">
                    <strong style="color: #0f172a;">Step 3: Verification</strong>
                    <div class="code-snippet">
                        <span style="color: #94a3b8;">-- Select data from the source table1</span><br>
                        <span style="color: #60a5fa;">SELECT</span> * <span style="color: #60a5fa;">FROM</span>
                        SOURCE_TABLE1 <span style="color: #fca5a5;">ORDER BY</span> ID ASC;
                    </div>
                    <div
                        style="background: white; border: 1px solid #ddd; padding: 10px; margin-top: 10px; border-radius: 6px;">
                        <span style="font-size: 0.85em; color: #666;">üìà Expect to see <strong>2 rows</strong> (Tom &
                            Sam).</span>
                    </div>
                </div>
            </div>

            <!-- Lab Phase 2 -->
            <div
                style="background: #fdf2f8; border: 2px solid #f9a8d4; border-radius: 12px; padding: 25px; margin-bottom: 30px;">
                <h3 style="color: #be185d; margin-top: 0; border-bottom: 2px solid #fbcfe8; padding-bottom: 10px;">üé•
                    Lab Phase 2: Installing the Camera</h3>
                <p>Now that our room (Table) is ready, let's install the security camera (Stream) to watch it.</p>

                <div class="substep" style="margin-bottom: 20px;">
                    <strong style="color: #be185d;">Step 4: Create Standard Stream</strong>
                    <div class="code-snippet">
                        <span style="color: #94a3b8;">-- Create a standard stream on the table</span><br>
                        <span style="color: #c084fc;">CREATE OR REPLACE STREAM</span> STANDARD_STREAM <span
                            style="color: #60a5fa;">ON TABLE</span> SOURCE_TABLE1;
                    </div>
                </div>

                <div class="substep">
                    <strong style="color: #be185d;">Step 5: Check the Stream (Verify)</strong>
                    <div class="code-snippet">
                        <span style="color: #94a3b8;">-- Select data from the standard stream</span><br>
                        <span style="color: #60a5fa;">SELECT</span> * <span style="color: #60a5fa;">FROM</span>
                        STANDARD_STREAM <span style="color: #fca5a5;">ORDER BY</span> ID ASC;
                    </div>

                    <div
                        style="background: white; border: 1px solid #ddd; padding: 10px; margin-top: 10px; border-radius: 6px; overflow-x: auto;">
                        <table class="metadata-table" style="margin-top: 5px; width: 100%;">
                            <tr style="background: #f3f4f6; color: #374151; font-size: 0.85em;">
                                <th>ID</th>
                                <th>NAME</th>
                                <th>CREATE_DATE</th>
                                <th>METADATA$ACTION</th>
                                <th>METADATA$ISUPDATE</th>
                                <th>METADATA$ROW_ID</th>
                            </tr>
                            <tr>
                                <td colspan="6"
                                    style="text-align: center; color: #999; padding: 20px; font-style: italic;">
                                    (0 rows) Query produced no results
                                </td>
                            </tr>
                        </table>
                    </div>

                    <p
                        style="font-size: 0.9em; background: #fff1f2; padding: 10px; border-radius: 4px; border-left: 4px solid #db2777; margin-top: 15px;">
                        <strong>üí° Critical Concept:</strong> Why is it empty? <br>
                        We inserted "Tom" & "Sam" <em>before</em> installing the camera. A Stream only records changes
                        that happen <strong>after</strong> creation. (It is not a time machine!)
                    </p>
                </div>
            </div>

        </div>

        <!-- Lab Phase 3 -->
        <div
            style="background: #ecfdf5; border: 2px solid #86efac; border-radius: 12px; padding: 25px; margin-bottom: 30px;">
            <h3 style="color: #059669; margin-top: 0; border-bottom: 2px solid #bbf7d0; padding-bottom: 10px;">üé¨ Lab
                Phase 3: Action!</h3>
            <p>The camera is rolling. Let's send someone new into the room.</p>

            <div class="substep" style="margin-bottom: 20px;">
                <strong style="color: #059669;">Step 6: Insert New Event</strong>
                <div class="code-snippet">
                    <span style="color: #94a3b8;">-- Insert new data into the source table1</span><br>
                    <span style="color: #fca5a5;">INSERT INTO</span> SOURCE_TABLE1 <span
                        style="color: #fca5a5;">VALUES</span> (3, <span style="color: #86efac;">'Johny'</span>, <span
                        style="color: #86efac;">'2025-11-01'</span>);
                </div>
            </div>

            <div class="substep">
                <strong style="color: #059669;">Step 7: Check the Source Room</strong>
                <div class="code-snippet">
                    <span style="color: #94a3b8;">-- Select data from the source table1</span><br>
                    <span style="color: #60a5fa;">SELECT</span> * <span style="color: #60a5fa;">FROM</span>
                    SOURCE_TABLE1 <span style="color: #fca5a5;">ORDER BY</span> ID ASC;
                </div>

                <div
                    style="background: white; border: 1px solid #ddd; padding: 10px; margin-top: 10px; border-radius: 6px; overflow-x: auto;">
                    <table class="metadata-table" style="margin-top: 5px; width: 100%;">
                        <tr style="background: #f3f4f6; color: #374151; font-size: 0.85em;">
                            <th>ID</th>
                            <th>NAME</th>
                            <th>CREATE_DATE</th>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>Tom</td>
                            <td>2025-10-31</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Sam</td>
                            <td>2025-10-31</td>
                        </tr>
                        <tr style="background: #dcfce7; font-weight: bold;">
                            <td>3</td>
                            <td>Johny</td>
                            <td>2025-11-01</td>
                        </tr>
                    </table>
                </div>
                <p style="font-size: 0.9em; background: #fff; padding: 5px; color: #666; margin-top: 5px;">
                    <em>(Note: Johny is now in the room. But did the camera see him?)</em>
                </p>
            </div>
        </div>

        <!-- Lab Phase 4 -->
        <div
            style="background: #ecfdf5; border: 2px solid #34d399; border-radius: 12px; padding: 25px; margin-bottom: 30px;">
            <h3 style="color: #047857; margin-top: 0; border-bottom: 2px solid #6ee7b7; padding-bottom: 10px;">‚ûï Lab
                Phase 4: The Append-Only Stream</h3>
            <p>What if we only care about <em>new arrivals</em> and want to ignore everyone else? We use an
                <strong>Append-Only</strong> stream.
            </p>

            <div class="substep" style="margin-bottom: 20px;">
                <strong style="color: #047857;">Step 8: Fresh Start (Table 2)</strong>
                <div class="code-snippet">
                    <span style="color: #94a3b8;">-- Create a source table2</span><br>
                    <span style="color: #c084fc;">CREATE OR REPLACE TABLE</span> SOURCE_TABLE2 ...;<br>
                    <span style="color: #94a3b8;">-- Insert initial records (Tom, Sam)</span><br>
                    <span style="color: #fca5a5;">INSERT INTO</span> SOURCE_TABLE2 <span
                        style="color: #fca5a5;">VALUES</span> ...;
                </div>
            </div>

            <div class="substep" style="margin-bottom: 20px;">
                <strong style="color: #047857;">Step 9: Create Append-Only Stream</strong>
                <div class="code-snippet">
                    <span style="color: #94a3b8;">-- Create a append only stream</span><br>
                    <span style="color: #c084fc;">CREATE OR REPLACE STREAM</span> APPEND_ONLY_STREAM <br>
                    <span style="color: #60a5fa;">ON TABLE</span> SOURCE_TABLE2 <br>
                    <span style="color: #f59e0b;">APPEND_ONLY = TRUE</span>;
                </div>
            </div>

            <div class="substep" style="margin-bottom: 20px;">
                <strong style="color: #047857;">Step 10: The New Arrival</strong>
                <div class="code-snippet">
                    <span style="color: #94a3b8;">-- Insert new data</span><br>
                    <span style="color: #fca5a5;">INSERT INTO</span> SOURCE_TABLE2 <span
                        style="color: #fca5a5;">VALUES</span> (3, <span style="color: #86efac;">'Johny'</span>, <span
                        style="color: #86efac;">'2025-11-01'</span>);
                </div>
            </div>

            <div class="substep">
                <strong style="color: #047857;">Step 11: Verify Append-Only Capture</strong>
                <div class="code-snippet">
                    <span style="color: #94a3b8;">-- Select data from the append only stream</span><br>
                    <span style="color: #60a5fa;">SELECT</span> * <span style="color: #60a5fa;">FROM</span>
                    APPEND_ONLY_STREAM;
                </div>

                <div
                    style="background: white; border: 1px solid #ddd; padding: 10px; margin-top: 10px; border-radius: 6px; overflow-x: auto;">
                    <table class="metadata-table" style="margin-top: 5px; width: 100%;">
                        <tr style="background: #f3f4f6; color: #374151; font-size: 0.85em;">
                            <th>ID</th>
                            <th>NAME</th>
                            <th>METADATA$ACTION</th>
                            <th>METADATA$ISUPDATE</th>
                        </tr>
                        <tr style="background: #dcfce7; font-weight: bold;">
                            <td>3</td>
                            <td>Johny</td>
                            <td><span style="color: #059669;">INSERT</span></td>
                            <td><span style="color: #dc2626;">FALSE</span></td>
                        </tr>
                    </table>
                </div>
                <p style="font-size: 0.9em; background: #fff; padding: 5px; color: #666; margin-top: 5px;">
                    <em>(Notice: The stream ONLY shows Johny. It ignores previous data!)</em>
                </p>
            </div>
        </div>

        <!-- Lab Phase 5 -->
        <div
            style="background: #ecfdf5; border: 2px solid #10b981; border-radius: 12px; padding: 25px; margin-bottom: 30px;">
            <h3 style="color: #065f46; margin-top: 0; border-bottom: 2px solid #34d399; padding-bottom: 10px;">üß™ Lab
                Phase 5: The Test (Update vs Insert)</h3>
            <p>Let's confuse the camera. We will <strong>change</strong> an existing person (Update) and
                <strong>add</strong> a new one (Insert).
            </p>

            <div class="substep" style="margin-bottom: 20px;">
                <strong style="color: #065f46;">Step 12: The Update (Transformation)</strong>
                <div class="code-snippet">
                    <span style="color: #94a3b8;">-- Update the source table2</span><br>
                    <span style="color: #fca5a5;">UPDATE</span> SOURCE_TABLE2 <span style="color: #60a5fa;">SET</span>
                    NAME = <span style="color: #86efac;">'Elon'</span> <span style="color: #fca5a5;">WHERE</span> ID =
                    1;
                </div>
            </div>

            <div class="substep" style="margin-bottom: 20px;">
                <strong style="color: #065f46;">Step 13: The Insert (New Arrival)</strong>
                <div class="code-snippet">
                    <span style="color: #94a3b8;">-- Insert new data into the source table2</span><br>
                    <span style="color: #fca5a5;">INSERT INTO</span> SOURCE_TABLE2 <span
                        style="color: #fca5a5;">VALUES</span> (4, <span style="color: #86efac;">'Sam'</span>, <span
                        style="color: #86efac;">'2025-11-02'</span>);
                </div>
            </div>

            <div class="substep" style="margin-bottom: 20px;">
                <strong style="color: #065f46;">Step 14: Check the Source Room</strong>
                <div class="code-snippet">
                    <span style="color: #60a5fa;">SELECT</span> * <span style="color: #60a5fa;">FROM</span>
                    SOURCE_TABLE2 <span style="color: #fca5a5;">ORDER BY</span> ID ASC;
                </div>
                <!-- Source Table Result -->
                <div
                    style="background: white; border: 1px solid #ddd; padding: 10px; margin-top: 10px; border-radius: 6px; overflow-x: auto;">
                    <table class="metadata-table" style="margin-top: 5px; width: 100%;">
                        <tr style="background: #f3f4f6; color: #374151; font-size: 0.85em;">
                            <th>ID</th>
                            <th>NAME</th>
                            <th>CREATE_DATE</th>
                        </tr>
                        <tr style="background: #eef2ff; font-weight: bold;">
                            <td>1</td>
                            <td>Elon</td>
                            <td>2025-10-31</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Johny</td>
                            <td>2025-11-01</td>
                        </tr>
                        <tr style="background: #eef2ff; font-weight: bold;">
                            <td>4</td>
                            <td>Sam</td>
                            <td>2025-11-02</td>
                        </tr>
                    </table>
                </div>
                <p style="font-size: 0.85em; color: #666; margin-top: 5px;">(Elon is updated. Sam is new. Total 3 rows.)
                </p>
            </div>

            <div class="substep">
                <strong style="color: #065f46;">Step 15: Check the Append-Only Stream</strong>
                <div class="code-snippet">
                    <span style="color: #60a5fa;">SELECT</span> * <span style="color: #60a5fa;">FROM</span>
                    APPEND_ONLY_STREAM <span style="color: #fca5a5;">ORDER BY</span> ID ASC;
                </div>

                <div
                    style="background: white; border: 1px solid #ddd; padding: 10px; margin-top: 10px; border-radius: 6px; overflow-x: auto;">
                    <table class="metadata-table" style="margin-top: 5px; width: 100%;">
                        <tr style="background: #f3f4f6; color: #374151; font-size: 0.85em;">
                            <th>ID</th>
                            <th>NAME</th>
                            <th>METADATA$ACTION</th>
                            <th>METADATA$ISUPDATE</th>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Johny</td>
                            <td><span style="color: #059669;">INSERT</span></td>
                            <td><span style="color: #dc2626;">FALSE</span></td>
                        </tr>
                        <tr style="background: #dcfce7; font-weight: bold;">
                            <td>4</td>
                            <td>Sam</td>
                            <td><span style="color: #059669;">INSERT</span></td>
                            <td><span style="color: #dc2626;">FALSE</span></td>
                        </tr>
                    </table>
                </div>

                <p
                    style="font-size: 0.9em; background: #fff7ed; padding: 10px; border-radius: 4px; border-left: 4px solid #ea580c; margin-top: 15px;">
                    <strong>üïµÔ∏è Conclusion:</strong> Where is Elon? <br>
                    He is missing from the stream! An <strong>Append-Only</strong> stream completely
                    <strong>ignored</strong> the UPDATE. It only saw the new INSERT (Sam/Johny).
                </p>
            </div>
        </div>
    </div>
    </div>

    <!-- Lab Phase 6 -->
    <div
        style="background: #fdf4ff; border: 2px solid #d946ef; border-radius: 12px; padding: 25px; margin-bottom: 30px;">
        <h3 style="color: #a21caf; margin-top: 0; border-bottom: 2px solid #f0abfc; padding-bottom: 10px;">üìâ Lab Phase
            6: Consuming the Stream</h3>
        <p>Streams are temporary holding areas. When we <strong>use</strong> the data (CONSUME), the stream advances its
            offset. It's like clearing the notification badge.</p>

        <div class="substep" style="margin-bottom: 20px;">
            <strong style="color: #a21caf;">Step 16: Prepare Final Destination</strong>
            <div class="code-snippet">
                <span style="color: #94a3b8;">-- Create a target table to hold the final data</span><br>
                <span style="color: #c084fc;">CREATE OR REPLACE TABLE</span> TARGET_TABLE2 <span
                    style="color: #60a5fa;">LIKE</span> SOURCE_TABLE2;
            </div>
        </div>

        <div class="substep" style="margin-bottom: 20px;">
            <strong style="color: #a21caf;">Step 17: The Consumption (Move Data)</strong>
            <div class="code-snippet">
                <span style="color: #94a3b8;">-- Insert data into target table from stream</span><br>
                <span style="color: #fca5a5;">INSERT INTO</span> TARGET_TABLE2<br>
                <span style="color: #60a5fa;">SELECT</span> ID, NAME, CREATE_DATE <span
                    style="color: #60a5fa;">FROM</span> APPEND_ONLY_STREAM;
            </div>

            <div
                style="background: white; border: 1px solid #ddd; padding: 10px; margin-top: 10px; border-radius: 6px; overflow-x: auto;">
                <table class="metadata-table" style="margin-top: 5px; width: 100%;">
                    <tr style="background: #f3f4f6; color: #374151; font-size: 0.85em;">
                        <th>status</th>
                        <th># number of rows inserted</th>
                    </tr>
                    <tr>
                        <td>...</td>
                        <td style="background: #fef08a; font-weight: bold;">2</td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="substep">
            <p
                style="font-size: 0.9em; background: #fae8ff; padding: 10px; border-radius: 4px; border-left: 4px solid #d946ef; margin-top: 15px;">
                <strong>üß† The "Magic" Trick:</strong><br>
                If you query <code>SELECT * FROM APPEND_ONLY_STREAM</code> <strong>now</strong>, it will be EMPTY!<br>
                Why? Because using the data in a DML statement (like INSERT) automatically <strong>advances the
                    offset</strong>. The camera has been reset.
            </p>
        </div>
    </div>

    <div style="background: #ecfdf5; padding: 20px; border-radius: 12px; border: 2px solid #10b981;">
        <h4 style="color: #059669; margin-top: 0;">‚úÖ Supported Objects</h4>
        <ul style="padding-left: 20px; margin-bottom: 0;">
            <li>Standard Tables</li>
            <li>Directory Tables</li>
            <li>External Tables</li>
            <li>Views</li>
        </ul>
    </div>

    <div style="background: #fef2f2; padding: 20px; border-radius: 12px; border: 2px solid #ef4444;">
        <h4 style="color: #b91c1c; margin-top: 0;">‚ùå NOT Supported</h4>
        <ul style="padding-left: 20px; margin-bottom: 0;">
            <li>Materialized Views</li>
            <li>Secure Objects (Secure Views, Secure UDFs)</li>
        </ul>
    </div>
    </div>

    </div>
    </div>

</body>

</html>