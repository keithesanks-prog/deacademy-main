<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Antics: AWS Glue</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Nunito:wght@400;700&display=swap');

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f0f9ff;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 900px;
            margin: 40px auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            border-bottom: 8px solid #0369a1;
        }

        .header {
            background: #0ea5e9;
            background: linear-gradient(135deg, #0ea5e9, #3b82f6);
            color: white;
            padding: 40px;
            text-align: center;
            border-bottom: 8px solid #0284c7;
        }

        .header h1 {
            font-family: 'Fredoka', sans-serif;
            font-size: 3em;
            margin: 0;
            text-shadow: 3px 3px 0px rgba(0, 0, 0, 0.2);
        }

        .content-block {
            padding: 40px;
        }

        .dialogue-box {
            background: #f0f9ff;
            border-left: 6px solid #0ea5e9;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 0 10px 10px 0;
            font-size: 1.1em;
        }

        .rob {
            font-weight: bold;
            color: #0369a1;
            font-family: 'Fredoka', sans-serif;
            font-size: 1.2em;
        }

        .kitchen-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .kitchen-card {
            background: #fff;
            border: 2px solid #e2e8f0;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            transition: transform 0.2s;
        }

        .kitchen-card:hover {
            transform: translateY(-5px);
            border-color: #0ea5e9;
        }

        .icon-large {
            font-size: 3em;
            display: block;
            margin-bottom: 10px;
        }

        .card-title {
            font-family: 'Fredoka';
            font-size: 1.4em;
            color: #0369a1;
            margin-bottom: 10px;
            display: block;
        }

        .tech-term {
            background: #e0f2fe;
            color: #0369a1;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-family: monospace;
            font-size: 0.9em;
        }

        .step-block {
            background: #fff;
            border: 2px solid #bae6fd;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            position: relative;
        }

        .step-number {
            position: absolute;
            top: -15px;
            left: 20px;
            background: #0ea5e9;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-family: 'Fredoka', sans-serif;
            font-weight: bold;
        }

        .console-action {
            background: #1e293b;
            color: #fff;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            margin: 10px 0;
            border-left: 5px solid #22c55e;
        }

        .analogy-title {
            text-align: center;
            color: #0c4a6e;
            font-family: 'Fredoka', sans-serif;
            font-size: 2em;
            margin-bottom: 30px;
        }
    </style>
</head>

<body>

    <div class="container">
        <div class="header">
            <h1>Cloud Antics</h1>
            <p>AWS Glue: The Data Library</p>
        </div>

        <div class="content-block">

            <div class="dialogue-box">
                <span class="rob">Rob:</span> "Glue is sticky... and confusing. Is it a database? A script? <br>
                Think of it as a <strong>Public Library</strong>. You have potential chaos (pile of books) and you need
                order."
            </div>

            <h2 class="analogy-title">üìö The Components</h2>

            <div class="kitchen-grid">
                <!-- S3 -->
                <div class="kitchen-card">
                    <span class="icon-large">üì¶</span>
                    <span class="card-title">The Book Stacks</span>
                    <span class="tech-term">S3 (Storage)</span>
                    <p>The dark basement where piles of files (Books/Scrolls) are thrown. Messy.</p>
                </div>

                <!-- Crawler -->
                <div class="kitchen-card">
                    <span class="icon-large">üïµÔ∏è‚Äç‚ôÇÔ∏è</span>
                    <span class="card-title">The Archivist</span>
                    <span class="tech-term">Glue Crawler</span>
                    <p>He walks into the basement, opens a box, reads a file, and says 'Aha! This is a
                        Comma-Separated-Novel with 3 columns!'</p>
                </div>

                <!-- Catalog -->
                <div class="kitchen-card">
                    <span class="icon-large">üóÑÔ∏è</span>
                    <span class="card-title">Card Catalog</span>
                    <span class="tech-term">Data Catalog</span>
                    <p><strong>He does NOT store the data.</strong> He just writes a card: 'Customer Data is on Shelf 3,
                        and it has Name, Age, Email.'</p>
                </div>

                <!-- Job -->
                <div class="kitchen-card">
                    <span class="icon-large">‚úçÔ∏è</span>
                    <span class="card-title">The Translator</span>
                    <span class="tech-term">Glue Job (ETL)</span>
                    <p>Reads the book using the Catalog, translates it (e.g., CSV to Parquet), and puts the new clean
                        book on a new shelf.</p>
                </div>

                <!-- Lake Formation -->
                <div class="kitchen-card" style="border-top: 5px solid #ef4444;">
                    <span class="icon-large">üëÆ‚Äç‚ôÇÔ∏è</span>
                    <span class="card-title">The Security Guard</span>
                    <span class="tech-term">Lake Formation</span>
                    <p><strong>The Permissions Layer.</strong> Just because you found the book (Catalog) doesn't mean
                        you can read it. LF controls the keys (Column-level access).</p>
                </div>

                <!-- Athena -->
                <div class="kitchen-card" style="border-top: 5px solid #ec4899;">
                    <span class="icon-large">üë©‚Äçüè´</span>
                    <span class="card-title">The Librarian</span>
                    <span class="tech-term">Amazon Athena</span>
                    <p><strong>The Query Engine.</strong> You don't need to move the books. She reads the Card Catalog
                        and fetches the answers (SQL) directly from the stacks (S3).</p>
                </div>
            </div>

            <!-- Triggers Section -->
            <div class="dialogue-box" style="border-left-color: #8b5cf6; background-color: #f5f3ff;">
                <span class="rob" style="color: #6d28d9;">Automation:</span> "Nobody likes to start work manually every
                day." <br>
                <strong>Triggers = The Alarm Clock.</strong><br>
                <ul style="margin-bottom: 0;">
                    <li><strong>Schedule:</strong> "Wake up at 8:00 AM" (CRON).</li>
                    <li><strong>Event-Based:</strong> "Wake up when the file arrives" (S3 Event or Crawler Finish).</li>
                </ul>
            </div>

            <!-- Script Editor Options -->
            <div class="vs-section" style="border-color: #8b5cf6; background-color: #f5f3ff; margin-top: 40px;">
                <h3 style="text-align: center; color: #5b21b6; margin-top: 0;">‚úçÔ∏è The Translator's Workshop (Script
                    Editor)</h3>
                <p style="text-align: center; margin-bottom: 20px;">When you create a Glue Job, you choose your tool.
                </p>

                <div class="vs-grid">
                    <div>
                        <h4 style="color: #6d28d9; border-bottom: 2px solid #6d28d9; padding-bottom: 5px;">Visual Editor
                        </h4>
                        <p><strong>Analogy:</strong> Building with Lego Blocks.</p>
                        <ul style="list-style-type: none; padding-left: 0;">
                            <li>‚úÖ <strong>Drag & Drop:</strong> No coding required.</li>
                            <li>‚úÖ <strong>Auto-Code:</strong> It writes the python for you in the background.</li>
                            <li>‚úÖ <strong>Best for:</strong> Simple conversions (CSV -> Parquet).</li>
                        </ul>
                    </div>
                    <div>
                        <h4 style="color: #6d28d9; border-bottom: 2px solid #6d28d9; padding-bottom: 5px;">Script Editor
                        </h4>
                        <p><strong>Analogy:</strong> The Typewriter.</p>
                        <ul style="list-style-type: none; padding-left: 0;">
                            <li>‚úÖ <strong>Total Control:</strong> Write raw PySpark or Scala.</li>
                            <li>‚úÖ <strong>Advanced:</strong> Use for complex logic not supported by visual blocks.</li>
                            <li>‚úÖ <strong>Notebooks:</strong> Interactive testing (like Jupyter).</li>
                        </ul>
                    </div>
                </div>

                <div style="margin-top: 20px; background: #ddd6fe; padding: 15px; border-radius: 8px; color: #4c1d95;">
                    <strong>üí™ Muscle Power (DPUs & Worker Types):</strong><br>
                    You must pay the Translator!
                    <ul style="margin-bottom: 0;">
                        <li><strong>Standard/G.1X:</strong> The Intern. Cheap, good for small books.</li>
                        <li><strong>G.2X:</strong> The Bodybuilder. Expensive, needed for massive libraries (TB of
                            data).</li>
                        <li><strong>DPU (Data Processing Unit):</strong> How many people are helping him read.</li>
                    </ul>
                </div>
            </div>

            <!-- Visual Editor Anatomy -->
            <div class="vs-section">
                <h3 style="text-align: center; color: #0369a1; margin-top: 0;">üßê Anatomy of the Visual Editor</h3>
                <p style="text-align: center; margin-bottom: 20px;">What are we looking at here?</p>

                <img src="glue_visual_editor.png" alt="Glue Visual Editor"
                    style="width: 100%; border-radius: 10px; border: 2px solid #bae6fd; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">

                <div class="kitchen-grid" style="margin-top: 20px;">
                    <div class="kitchen-card">
                        <span class="icon-large">üî™</span>
                        <span class="card-title">The Node (Change Schema)</span>
                        <p><strong>Analogy: The Chopping Board.</strong><br>
                            You take the raw Ingredient (Source) and modify it. <br>
                            <em>Use it to:</em> Rename columns (<code>timestamp</code> -> <code>event_time</code>) or
                            Drop useless ones (<code>partition_0</code>).
                        </p>
                    </div>
                    <div class="kitchen-card">
                        <span class="icon-large">üëÄ</span>
                        <span class="card-title">Data Preview</span>
                        <p><strong>Analogy: The Taste Test.</strong><br>
                            "Did I chop it right?" <br>
                            It shows you a <strong>Sample (200 rows)</strong> of what the data looks like <em>after</em>
                            that specific transformation step.</p>
                    </div>
                </div>

                <div style="background: #eff6ff; padding: 15px; border-radius: 8px; border-left: 5px solid #3b82f6;">
                    <strong>Why is this cool?</strong><br>
                    You can inspect your data at <em>every single step</em> of the pipeline without running the whole
                    job. It's like tasting the soup after adding salt, then again after adding pepper.
                </div>
            </div>

            <!-- Job Bookmark -->
            <div class="dialogue-box" style="border-left-color: #f59e0b; background-color: #fffbeb;">
                <span class="rob" style="color: #b45309;">Concept Alert:</span> "What if I add new pages to the book?"
                <br>
                <strong>Job Bookmark = The Literal Bookmark.</strong><br>
                The Translator remembers exactly where he stopped reading last time. <br>
                <em>Result:</em> He only translates the <strong>NEW</strong> pages (Incremental Load), not the whole
                book again. Saves time & money!
            </div>

            <hr style="border: 0; border-top: 2px dashed #cbd5e1; margin: 40px 0;">

            <div class="dialogue-box">
                <span class="rob">Lab Time:</span> "Let's hire an Archivist! We will <strong>Crawl</strong> a file to
                see its schema magically appear."
            </div>

            <!-- LAB STEP 1 -->
            <div class="step-block">
                <div class="step-number">Step 1</div>
                <h3 style="margin-top: 10px;">The Mess (Upload Data)</h3>
                <p>Create a file called <code>customers.csv</code> locally:</p>
                <div class="console-action">
                    id,name,email<br>
                    1,Rob,rob@antics.cloud<br>
                    2,Sarah,sarah@aws.com
                </div>
                <p>1. Create a folder named <code>raw</code> in your S3 Bucket.<br>
                    2. Upload the file into it. (Path: <code>s3://my-data-lake-bucket/raw/customers.csv</code>).</p>
            </div>

            <!-- LAB STEP 2 -->
            <div class="step-block">
                <div class="step-number">Step 2</div>
                <h3 style="margin-top: 10px;">Hire the Archivist (Create Crawler)</h3>
                <div class="console-action">
                    1. Go to <strong>AWS Glue</strong> -> <strong>Crawlers</strong>.<br>
                    2. Click <strong>Create Crawler</strong>.<br>
                    3. Name: <strong>customer-scanner</strong>.<br>
                    4. Data Source: Select your S3 folder (<code>s3://my-data-lake-bucket/raw/</code>).<br>
                    5. IAM Role: Create verify provided role has <strong>AWSGlueServiceRole</strong>.<br>
                    <div
                        style="background: #fee2e2; padding: 10px; margin-top: 5px; border-left: 4px solid #ef4444; font-size: 0.9em; color: #991b1b;">
                        <strong>üëÆ Security Alert (Lake Formation):</strong><br>
                        If you use Lake Formation, you <strong>MUST</strong> explicitly grant this IAM Role permission
                        to the Database. Otherwise, the Archivist gets kicked out.
                    </div>
                    <div
                        style="background: #fff7ed; padding: 10px; margin-top: 5px; border-left: 4px solid #f97316; font-size: 0.9em; color: #7c2d12;">
                        <strong>üö´ Error: "Account is denied access"?</strong><br>
                        The Security Guard (Lake Formation) blocked <strong>YOU</strong> (the human).
                        <ul style="margin: 5px 0; padding-left: 20px;">
                            <li><strong>Step 1:</strong> Go to <strong>Lake Formation</strong> -> <strong>Data Lake
                                    Administrators</strong>.</li>
                            <li><strong>Step 2:</strong> Click <strong>Add</strong>.</li>
                            <li><strong>Step 3 (CRITICAL):</strong> Search for <strong>YOUR username</strong>.
                                <br><em>Note:</em> If you are <strong>Root</strong> and it says "Invalid", Lake
                                Formation has blocked Root. You <strong>MUST</strong> create a new IAM User (attach
                                <code>AdministratorAccess</code> policy) and log in as them.
                            </li>
                            <li><strong>Step 4:</strong> Also add the <strong>AWSGlueServiceRole</strong> just in case.
                            </li>
                            <li><strong>Step 5:</strong> Click <strong>Save</strong>.</li>
                        </ul>
                        <img src="glue_admin_valid.png" alt="Valid Lake Formation Admin"
                            style="margin-top: 10px; border-radius: 5px; border: 1px solid #22c55e; width: 100%;">

                        <div style="margin-top: 10px; border-top: 1px dashed #f97316; padding-top: 10px;">
                            <strong>Still getting blocked?</strong><br>
                            Sometimes Admin isn't enough. <br>
                            1. Go to <strong>Lake Formation</strong> -> <strong>Data Lake Locations</strong> -> Verify
                            your bucket is registered.<br>
                            2. Go to <strong>Databases</strong> -> <code>my_library_db</code> ->
                            <strong>Actions</strong> -> <strong>Grant</strong>.<br>
                            3. Select <strong>glue-admin</strong> (yourself) -> Check <strong>ALL Permissions</strong>
                            (Create Table, etc).<br>
                            4. Click <strong>Grant</strong>.
                        </div>
                    </div>
                    6. Target Database: Click "Add Database" -> <strong>my_library_db</strong>.<br>
                    7. Click <strong>Create</strong>.
                </div>
            </div>

            <!-- LAB STEP 3 -->
            <div class="step-block">
                <div class="step-number">Step 3</div>
                <h3 style="margin-top: 10px;">Do the Work (Run Crawler)</h3>
                <p>The Archivist exists, but he is sleeping. Wake him up.</p>
                <div class="console-action">
                    1. Select <strong>customer-scanner</strong>.<br>
                    2. Click <strong>Run Crawler</strong>.<br>
                    3. Wait... (Status: Starting -> Running -> Stopping -> Ready).
                </div>
            </div>

            <!-- LAB STEP 4 -->
            <div class="step-block">
                <div class="step-number">Step 4</div>
                <h3 style="margin-top: 10px;">Check the Catalog (Verify)</h3>
                <p>Did he do his job? Let's check the cards.</p>
                <div class="console-action">
                    1. Go to <strong>Data Catalog</strong> -> <strong>Tables</strong>.<br>
                    2. Click on the new table (likely named <code>raw</code>, <code>customers</code>, or
                    <code>customer-scanner</code>).<br>
                    3. Scroll down to <strong>Schema</strong>.<br>
                    ‚úÖ You should see: <strong>id (bigint), name (string), email (string)</strong>.
                </div>
                <p style="color: green; font-weight: bold;">Magic! He read the CSV header and figured it out.</p>
            </div>

            <!-- LAB PART 2: ETL -->
            <div class="dialogue-box">
                <span class="rob">Lab Part 2:</span> "Now the file is in the Library. Let's translate it! We will
                <strong>Drop a Column</strong> and save it as Parquet."
            </div>

            <!-- LAB STEP 5 -->
            <div class="step-block">
                <div class="step-number">Step 5</div>
                <h3 style="margin-top: 10px;">The Workshop (Create Job)</h3>
                <div class="console-action">
                    1. Go to <strong>AWS Glue</strong> -> <strong>ETL Jobs</strong>.<br>
                    2. Select <strong>Visual ETL</strong>.<br>
                    3. Source: Select <strong>Data Catalog</strong> (Node 1).<br>
                    4. Database: <code>my_library_db</code> | Table: <code>raw</code>.
                </div>
            </div>

            <!-- LAB STEP 6 -->
            <div class="step-block">
                <div class="step-number">Step 6</div>
                <h3 style="margin-top: 10px;">The Chop (Transform)</h3>
                <div class="console-action">
                    1. Click <strong>+</strong> to add a Node -> <strong>Transform</strong> -> <strong>Drop
                        Fields</strong>.<br>
                    2. Check the box for <code>email</code> (or <code>phone</code> if you have it). We are censoring
                    it!<br>
                    3. Click "Data Preview" tab to see it vanish.
                </div>
            </div>

            <!-- LAB STEP 7 -->
            <div class="step-block">
                <div class="step-number">Step 7</div>
                <h3 style="margin-top: 10px;">The New Book (Target & Run)</h3>
                <div class="console-action">
                    1. Click <strong>+</strong> -> <strong>Target</strong> -> <strong>Amazon S3</strong>.<br>
                    2. Format: <strong>Parquet</strong>.<br>
                    3. Path: <code>s3://my-bucket/processed/</code>.<br>
                    4. <strong>Job Details</strong> tab -> Select your <strong>IAM Role</strong>.<br>
                    5. Click <strong>Run</strong>.
                </div>
                <p style="color: green; font-weight: bold;">Result: You now have a clean Parquet file in your
                    'processed' folder!</p>
            </div>

            <hr style="border: 0; border-top: 2px dashed #cbd5e1; margin: 40px 0;">

            <!-- VISUAL BREAKDOWN -->
            <div class="vs-section">
                <h3 style="text-align: center; color: #0369a1; margin-top: 0;">üì∏ Visual Breakdown</h3>
                <p style="text-align: center; margin-bottom: 20px;">Let's decode the screens you just saw.</p>

                <!-- Crawler Image -->
                <div class="step-block" style="border-color: #fbbf24;">
                    <h4 style="margin: 0 0 10px 0; color: #b45309;">1. The Archivist's Badge (Crawler)</h4>
                    <img src="glue_crawler_screen.png" alt="Crawler Screen"
                        style="width: 100%; border-radius: 8px; border: 1px solid #ccc;">
                    <div style="margin-top: 10px; font-size: 0.9em;">
                        <strong>Key Insight:</strong> See <code>State: READY</code>? That means he is waiting for
                        orders. <br>
                        <strong>Database: gluesession</strong> -> This is <em>where</em> he will file the cards.
                    </div>
                </div>

                <!-- Job Role Image -->
                <div class="step-block" style="border-color: #f87171;">
                    <h4 style="margin: 0 0 10px 0; color: #b91c1c;">2. The Security Check (IAM Role)</h4>
                    <img src="glue_job_role_screen.png" alt="Job Role Screen"
                        style="width: 100%; border-radius: 8px; border: 1px solid #ccc;">
                    <div style="margin-top: 10px; font-size: 0.9em;">
                        <strong style="color: #dc2626;">"IAM Role is required"</strong><br>
                        This is the Badge. The Job (Translator) cannot enter the Library (S3) without it. <br>
                        <em>Fix:</em> Select a role that has <strong>AWSGlueServiceRole</strong> permissions.
                    </div>
                </div>

                <!-- Target Image -->
                <div class="step-block" style="border-color: #818cf8;">
                    <h4 style="margin: 0 0 10px 0; color: #4338ca;">3. The Destination (S3 Target)</h4>
                    <img src="glue_target_screen.png" alt="S3 Target Screen"
                        style="width: 100%; border-radius: 8px; border: 1px solid #ccc;">
                    <div style="margin-top: 10px; font-size: 0.9em;">
                        <strong>Data Target:</strong> This is where the Translator puts the <em>finished</em> book. <br>
                        Notice <code>Format: JSON/Parquet</code>? You are choosing the language of the new book.
                    </div>
                </div>

                <!-- Database Image -->
                <div class="step-block" style="border-color: #34d399;">
                    <h4 style="margin: 0 0 10px 0; color: #047857;">4. The Card Catalog (Database View)</h4>
                    <img src="glue_database_screen.png" alt="Database Screen"
                        style="width: 100%; border-radius: 8px; border: 1px solid #ccc;">
                    <div style="margin-top: 10px; font-size: 0.9em;">
                        <strong>This is NOT a Folder.</strong> It is a logic group.<br>
                        See the table <code>scheduled_calls</code>? <br>
                        <strong>Location:</strong> <code>s3://pvh-kareem/...</code> <br>
                        Proof that the Catalog just <em>points</em> to S3. It doesn't hold the data.
                    </div>
                </div>

            </div>

        </div>
    </div>

</body>

</html>